# **Chapter 7. 스마트 컨트랙트와 솔리디티**
> 본 글은 『Mastering Ethereum』을 읽고 정리한 내용입니다.

이더리움에는 외부 소유 계정(EOA)과 컨트랙트 계정이라는 두 가지 유형의 계정이 있다. EOA는 이더리움 플랫폼의 외부에 있는 지갑 애플리케이션 같은 소프트웨어를 통해 사용자가 제어한다. 반대로, 컨트랙트 계정은 이더리움 가상 머신에 의해 실행되는 프로그램 코드(일반적으로 '스마트 컨트랙트'라고 함)가 제어한다. 즉, EOA는 관련 코드나 데이터 저장소가 없는 간단한 계정이지만, 컨트랙트 계정은 관련 코드와 데이터 저장소를 모두 갖고 있다. 컨트랙트 계정은 개인키를 갖지 않으므로 스마트 컨트랙트에 규정된 미리 결정된 방식으로 '스스로 제어' 하는 반면, EOA는 프로토콜 외부에 있어서 프로토콜에 독립적인 '실제 세계'의 개인키로 생성되고 암호로 서명된 거래에 의해 제어된다. 두 가지 유형의 계정은 모두 이더리움 주소로 식별된다. 이 장에서는 컨트랙트 계정과 이를 제어하는 프로그램 코드에 대해 설명한다.

## **1. 스마트 컨트랙트란 무엇인가?**

`스마트 컨트랙트(smart contract)`라는 용어는 다양한 것들을 설명하기 위해 수년 동안 사용되어 왔다. 1990년대 암호학자 닉 사보(Nick Szabo)는 이 용어를 "당사자들이 다른 약속에 따라 수행하는 프로토콜을 포함하여 디지털 형식으로 지정된 일련의 약속"이라고 정의했다. 그 이후로 스마트 컨트랙트의 개념은, 특히 2009년 비트코인의 발명으로 탈중앙화 블록체인 플랫폼이 도입된 후에 진화했다. 이더리움의 컨텍스트에서 이더리움 스마트 컨트랙트는 스마트하지도 않고 법적 컨트랙트도 아니기 때문에 다소 잘못된 이름임에도 이미 확고하게 자리를 잡았다. 이 책에서는 '스마트 컨트랙트'라는 용어를 불변적인(immutable) 컴퓨터 프로그램을 지칭하는데, 이 프로그램은 이더리움 네트워크 프로토콜(즉, 탈중앙화된 이더리움 월드 컴퓨터)의 일부인 이더리움 가상 머신의 컨텍스트상에서 결정론적으로(deterministically) 작동한다. 이제 스마트 컨트랙트의 정의를 살펴보자.

**컴퓨터 프로그램(computer programs)**

* 스마트 컨트랙트는 단순히 컴퓨터 프로그램이다. '컨트랙트(contract)'라는 단어는 이런 맥락에서 법적인 의미는 없다.

**불변의(immutable)**

* 스마트 컨트랙트 코드는 일단 배포되면, 변경할 수 없다. 기존 소프트웨어와 달리 스마트 컨트랙트를 수정하는 유일한 방법은 새로운 인스턴스를 배포하는 것이다.

**결정론적(deterministic)**

* 스마트 컨트랙트를 실행한 결과물은 그것을 실행한 모든 이에게 동일한데, 실행을 시작한 트랜잭션의 컨텍스트와 실행 시점에 이더리움 블록체인의 상태가 동일하다는 전제가 있기 때문이다.

**EVM 컨텍스트(EVM context)**

* 스마트 컨트랙트는 매우 제한적인 실행 컨텍스트에서 작동한다. 이들은 자신의 상태, 호출한 트랜잭션의 컨텍스트 및 가장 최근 블록의 일부 정보에 접근할 수 있다.

**탈중앙화된 월드 컴퓨터(decentralized world computer)**

* EVM은 모든 이더리움 노드에서 로컬 인스턴스로 실행되지만, EVM의 모든 인스턴스는 동일한 초기 상태에서 작동하고 동일한 최종 상태를 생성하기 때문에 시스템 전체가 단일 '월드 컴퓨터'로 작동한다.

## **2. 스마트 컨트랙트의 생명주기**

스마트 컨트랙트는 일반적으로 솔리디티 같은 고급 언어로 작성된다.

