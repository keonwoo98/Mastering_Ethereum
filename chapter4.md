# **Chapter 4. 암호학**
> 본 글은 『Mastering Ethereum』을 읽고 정리한 내용입니다.

이더리움의 기반 기술 중 하나는 컴퓨터 보안에 광범위하게 사용되는 수학의 한 분야인 `암호학(cryptography)`이다. 암호학은 그리스어로 `비밀 작성`을 의미하지만, 암호학 연구는 `암호화(encryption)`라고 하는 단순한 비밀 작성 이상의 것을 포함한다. 예를 들어 암호학은 그 비밀을 밝히지 않고 비밀의 지식을 증명하거나(예: 디지털 서명을 사용하여), 데이터의 진위성을 증명하는 데(예: 해시라고도 알려진 디지털 지문을 활용하여) 사용할 수 있다. 이런 유형의 암호화 증명은 이더리움 플랫폼(실제로 모든 블록체인 시스템)의 작동을 위한 중요한 수학 도구이며, 이더리움 애플리케이션에도 광범위하게 사용한다.

출판 시점 기준으로 이더리움 프로토콜의 어떤 부분도 암호화되어 있지 않다. 즉, 이더리움 플랫폼과 노드 간(트랜잭션 데이터 포함)의 모든 통신은 암호화되어 있지 않고, (따라서) 누구나 그 내용을 읽을 수 있다. 이렇게 해서 모든 사람이 상태 업데이트의 정확성을 확인할 수 있고, 합의에 도달할 수 있다. 향후에는 영 지식 증명(zero knowledge proof)과 동형 암호화(homomorphic encryption) 같은 고급 암호화 도구를 사용하여 여전히 합의를 가능하게 하면서도 암호화된 계산을 블록체인에 기록할 수 있을 것이다. 하지만 고급 암호화 도구를 제공할 준비는 마쳤으나 아직 배포되지는 않았다.

이 장에서는 이더리움에서 사용하는 암호 방식, 즉 개인키와 주소의 형태로 자금의 소유권을 제어하는 데 사용되는 공개키 암호화(Public Key Cryptography, PKC)를 소개한다.

## **1. 키와 주소**

이더리움은 `외부 소유 계정(Externally Owned Account, EOA)`과 `컨트랙트(contract)`라는 두 가지 유형을 계정을 갖고 있다. 디지털 `개인키(private key)`, `이더리움 주소(Ethereum address)`, `디지털 서명(digital signature)`을 통해 외부 소유 계정의 이더 소유권을 확립한다. 개인키는 모든 사용자와 이더리움 간 상호작용의 핵심이다. 사실, 계정 주소는 개인키에서 직접 파생되고, 개인키는 `계정(account)`이라고도 불리는 단일 이더리움 줏를 고유하게 결정한다.

이더리움 시스템은 개인키를 이더리움에 전송하거나 저장하는 방식으로 직접 사용하지 않는다. 즉, 개인키는 비공개로 유지되어야 하고, 네트워크로 전달된 메시지에 나타나지 않으며, 체인에 저장되어서도 안 된다. 계정 주소와 디지털 서명만 이더리움 시스템에 전송되고 저장된다. 개인키는 안전하고 확실하게 보관해야 한다.

개인키를 사용하여 생성된 디지털 서명을 통해 자금의 접근과 통제가 이루어진다. 이더리움 트랜잭션은 유효한 디지털 서명이 블록체인에 있어야 한다. 개인키의 사본을 가진 사람은 누구나 해당 계정과 해당 계정이 가진 이더를 제어할 수 있다. 사용자가 자신의 개인키를 안전하게 유지한다면, 이더리움 트랜잭션의 디지털 서명은 개인키의 소유권을 증명하기 때문에 자금의 실제 소유자임도 증명한다.

이더리움에서 사용하는 것과 같은 공개키 암호화 기반 시스템에서 키는 개인(비밀)키와 공개키로 구성된 쌍으로 제공한다. 공개키는 은행 계좌 번호와, 개인키는 PIN(개인 식별 번호)과 유사하다고 생각해 보자. 후자는 계정에 대한 제어권을 제공하고, 전자를 가지고 계정을 식별할 수 있다. 개인키 자체는 이더리움 사용자에게 드러나는 경우가 거의 없다. 대부분 암호화된 형태로 특수 파일에 저장하고, 이더리움 지갑 소프트웨어로 관리한다.

이더리움 트랜잭션의 지급 부분에서 지정된 수신자는 이더리움 주소로 표시하며, 이 주소는 은행 송금의 수익자 계좌 세부 정보와 동일한 방식으로 사용한다. 이후에 자세히 볼 수 있듯이 외부 소유 계정의 이더리움 주소는 공개키-개인키 쌍의 공개키 부분에서 생성된다. 그러나 모든 이더리움 주소가 공개키-개인키 쌍을 나타내는 것은 아니다. 개인키로 뒷받침되지 않는 컨트랙트를 표시할 수도 있다.

## **2. 공개키 암호화와 암호화폐**

공개키 암호화(비대칭 암호화라고도 함)는 오늘날 정보 보안의 핵심 요소다. 1970년대 마틴 헬먼(Martin Hellman), 휫필드 디피(Whitfield Diffie), 랄프 머클(Ralph Merkle)이 처음 공개한 이 기법은 암호학 분야에서 대중의 관심을 불러일으킨 기념비적인 돌파구였다. 70년대 이전에, 정부는 강력한 암호학 지식을 비밀로 유지했다.

공개키 암호화는 고유한 키를 사용하여 정보를 보호한다. 이 키는 특수한 속성(계산하기는 쉽지만 그 역(inverse)을 계산하기는 어렵다)을 가진 수학 함수를 바탕으로 한다. 이런 함수를 바탕으로한 암호화는 디지털 비밀과 위조 불가능한 디지털 서명을 만들 수 있으며, 이것은 수학 법칙에 의해 보장받는다.

예를 들어, 2개의 큰 소수를 곱하는 것은 아주 간단하다. 그러나 2개의 큰 소수의 곱을 감안할 때 소인수(`소인수 분해(prime factorization)`라고 하는 문제)를 찾는 문제는 매우 어렵다. 8,018,009라는 숫자가 두 소수의 결과라고 제시했을 때 그 두 소수를 찾는 것이 8,018,009를 만들기 위해 그 소수를 곱하는 것보다 훨씬 더 어렵다.

이런 수학 함수 중 일부는 비밀 정보를 알고 있을 때 쉽게 거꾸로 계산할 수 있다. 앞의 예에서 소인수 중 하나가 2,003이라고 하면, 간단히 나머지 소인수를 쉽게 찾을 수 있다(8,018,009 ÷ 2,003 = 4,003). 이런 함수는 역산하기 위한 단축키로 사용할 수 있는 비밀 정보가 없으면 거꾸로 계산하기 어렵기 때문에 `트랩 도어 함수(trapdoor function)`라고도 한다.

암호화에 유용한 수학 함수의 좀 더 발전된 범주는 타원 곡선의 산술 연산을 바탕으로 한다. 타원 곡선 산술에서 소수로 나눈 나머지를 곱하는 것은 간단하지만, 나눗셈(역함수)은 사실상 불가능하다. 이것을 `이산 로그 문제(discrete logarithm problem)`라고 하며, 현재는 알려진 트랩 도어는 없다. `타원 곡선 암호화(elliptic curve cyptography)`는 최신 컴퓨터 시스템에서 광범위하게 활용되며, 이더리움(및 기타 암호화폐)에서 개인키와 디지털 서명을 사용하는 기초가 된다.

> * [암호학 WIKI](https://en.wikipedia.org/wiki/Cryptography)
> * [트랩 도어 함수 WIKI](https://en.wikipedia.org/wiki/Trapdoor_function)
> * [소인수 분해](https://en.wikipedia.org/wiki/Integer_factorization)
> * [이산 로그](https://en.wikipedia.org/wiki/Discrete_logarithm)
> * [타원 곡선 암호화](https://en.wikipedia.org/wiki/Elliptic-curve_cryptography)

