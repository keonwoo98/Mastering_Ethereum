# **Chapter 4. μ•”νΈν•™**
> λ³Έ κΈ€μ€ γ€Mastering Ethereumγ€μ„ μ½κ³  μ •λ¦¬ν• λ‚΄μ©μ…λ‹λ‹¤.

μ΄λ”λ¦¬μ›€μ κΈ°λ° κΈ°μ  μ¤‘ ν•λ‚λ” μ»΄ν“¨ν„° λ³΄μ•μ— κ΄‘λ²”μ„ν•κ² μ‚¬μ©λλ” μν•™μ ν• λ¶„μ•ΌμΈ `μ•”νΈν•™(cryptography)`μ΄λ‹¤. μ•”νΈν•™μ€ κ·Έλ¦¬μ¤μ–΄λ΅ `λΉ„λ°€ μ‘μ„±`μ„ μλ―Έν•μ§€λ§, μ•”νΈν•™ μ—°κµ¬λ” `μ•”νΈν™”(encryption)`λΌκ³  ν•λ” λ‹¨μν• λΉ„λ°€ μ‘μ„± μ΄μƒμ κ²ƒμ„ ν¬ν•¨ν•λ‹¤. μλ¥Ό λ“¤μ–΄ μ•”νΈν•™μ€ κ·Έ λΉ„λ°€μ„ λ°νμ§€ μ•κ³  λΉ„λ°€μ μ§€μ‹μ„ μ¦λ…ν•κ±°λ‚(μ: λ””μ§€ν„Έ μ„λ…μ„ μ‚¬μ©ν•μ—¬), λ°μ΄ν„°μ μ§„μ„μ„±μ„ μ¦λ…ν•λ” λ°(μ: ν•΄μ‹λΌκ³ λ„ μ•λ ¤μ§„ λ””μ§€ν„Έ μ§€λ¬Έμ„ ν™μ©ν•μ—¬) μ‚¬μ©ν•  μ μλ‹¤. μ΄λ° μ ν•μ μ•”νΈν™” μ¦λ…μ€ μ΄λ”λ¦¬μ›€ ν”λ«νΌ(μ‹¤μ λ΅ λ¨λ“  λΈ”λ΅μ²΄μΈ μ‹μ¤ν…)μ μ‘λ™μ„ μ„ν• μ¤‘μ”ν• μν•™ λ„κµ¬μ΄λ©°, μ΄λ”λ¦¬μ›€ μ• ν”λ¦¬μΌ€μ΄μ…μ—λ„ κ΄‘λ²”μ„ν•κ² μ‚¬μ©ν•λ‹¤.

μ¶ν μ‹μ  κΈ°μ¤€μΌλ΅ μ΄λ”λ¦¬μ›€ ν”„λ΅ν† μ½μ μ–΄λ–¤ λ¶€λ¶„λ„ μ•”νΈν™”λμ–΄ μμ§€ μ•λ‹¤. μ¦‰, μ΄λ”λ¦¬μ›€ ν”λ«νΌκ³Ό λ…Έλ“ κ°„(νΈλμ­μ… λ°μ΄ν„° ν¬ν•¨)μ λ¨λ“  ν†µμ‹ μ€ μ•”νΈν™”λμ–΄ μμ§€ μ•κ³ , (λ”°λΌμ„) λ„κµ¬λ‚ κ·Έ λ‚΄μ©μ„ μ½μ„ μ μλ‹¤. μ΄λ ‡κ² ν•΄μ„ λ¨λ“  μ‚¬λμ΄ μƒνƒ μ—…λ°μ΄νΈμ μ •ν™•μ„±μ„ ν™•μΈν•  μ μκ³ , ν•©μμ— λ„λ‹¬ν•  μ μλ‹¤. ν–¥ν›„μ—λ” μ μ§€μ‹ μ¦λ…(zero knowledge proof)κ³Ό λ™ν• μ•”νΈν™”(homomorphic encryption) κ°™μ€ κ³ κΈ‰ μ•”νΈν™” λ„κµ¬λ¥Ό μ‚¬μ©ν•μ—¬ μ—¬μ „ν ν•©μλ¥Ό κ°€λ¥ν•κ² ν•λ©΄μ„λ„ μ•”νΈν™”λ κ³„μ‚°μ„ λΈ”λ΅μ²΄μΈμ— κΈ°λ΅ν•  μ μμ„ κ²ƒμ΄λ‹¤. ν•μ§€λ§ κ³ κΈ‰ μ•”νΈν™” λ„κµ¬λ¥Ό μ κ³µν•  μ¤€λΉ„λ” λ§μ³¤μΌλ‚ μ•„μ§ λ°°ν¬λμ§€λ” μ•μ•λ‹¤.

μ΄ μ¥μ—μ„λ” μ΄λ”λ¦¬μ›€μ—μ„ μ‚¬μ©ν•λ” μ•”νΈ λ°©μ‹, μ¦‰ κ°μΈν‚¤μ™€ μ£Όμ†μ ν•νƒλ΅ μκΈμ μ†μ κ¶μ„ μ μ–΄ν•λ” λ° μ‚¬μ©λλ” κ³µκ°ν‚¤ μ•”νΈν™”(Public Key Cryptography, PKC)λ¥Ό μ†κ°ν•λ‹¤.

## **1. ν‚¤μ™€ μ£Όμ†**

μ΄λ”λ¦¬μ›€μ€ `μ™Έλ¶€ μ†μ  κ³„μ •(Externally Owned Account, EOA)`κ³Ό `μ»¨νΈλ™νΈ(contract)`λΌλ” λ‘ κ°€μ§€ μ ν•μ„ κ³„μ •μ„ κ°–κ³  μλ‹¤. λ””μ§€ν„Έ `κ°μΈν‚¤(private key)`, `μ΄λ”λ¦¬μ›€ μ£Όμ†(Ethereum address)`, `λ””μ§€ν„Έ μ„λ…(digital signature)`μ„ ν†µν•΄ μ™Έλ¶€ μ†μ  κ³„μ •μ μ΄λ” μ†μ κ¶μ„ ν™•λ¦½ν•λ‹¤. κ°μΈν‚¤λ” λ¨λ“  μ‚¬μ©μμ™€ μ΄λ”λ¦¬μ›€ κ°„ μƒνΈμ‘μ©μ ν•µμ‹¬μ΄λ‹¤. μ‚¬μ‹¤, κ³„μ • μ£Όμ†λ” κ°μΈν‚¤μ—μ„ μ§μ ‘ νμƒλκ³ , κ°μΈν‚¤λ” `κ³„μ •(account)`μ΄λΌκ³ λ„ λ¶λ¦¬λ” λ‹¨μΌ μ΄λ”λ¦¬μ›€ μ£Όμ†λ¥Ό κ³ μ ν•κ² κ²°μ •ν•λ‹¤.

μ΄λ”λ¦¬μ›€ μ‹μ¤ν…μ€ κ°μΈν‚¤λ¥Ό μ΄λ”λ¦¬μ›€μ— μ „μ†΅ν•κ±°λ‚ μ €μ¥ν•λ” λ°©μ‹μΌλ΅ μ§μ ‘ μ‚¬μ©ν•μ§€ μ•λ”λ‹¤. μ¦‰, κ°μΈν‚¤λ” λΉ„κ³µκ°λ΅ μ μ§€λμ–΄μ•Ό ν•κ³ , λ„¤νΈμ›ν¬λ΅ μ „λ‹¬λ λ©”μ‹μ§€μ— λ‚νƒ€λ‚μ§€ μ•μΌλ©°, μ²΄μΈμ— μ €μ¥λμ–΄μ„λ„ μ• λλ‹¤. κ³„μ • μ£Όμ†μ™€ λ””μ§€ν„Έ μ„λ…λ§ μ΄λ”λ¦¬μ›€ μ‹μ¤ν…μ— μ „μ†΅λκ³  μ €μ¥λλ‹¤. κ°μΈν‚¤λ” μ•μ „ν•κ³  ν™•μ‹¤ν•κ² λ³΄κ΄€ν•΄μ•Ό ν•λ‹¤.

κ°μΈν‚¤λ¥Ό μ‚¬μ©ν•μ—¬ μƒμ„±λ λ””μ§€ν„Έ μ„λ…μ„ ν†µν•΄ μκΈμ μ ‘κ·Όκ³Ό ν†µμ κ°€ μ΄λ£¨μ–΄μ§„λ‹¤. μ΄λ”λ¦¬μ›€ νΈλμ­μ…μ€ μ ν¨ν• λ””μ§€ν„Έ μ„λ…μ΄ λΈ”λ΅μ²΄μΈμ— μμ–΄μ•Ό ν•λ‹¤. κ°μΈν‚¤μ μ‚¬λ³Έμ„ κ°€μ§„ μ‚¬λμ€ λ„κµ¬λ‚ ν•΄λ‹Ή κ³„μ •κ³Ό ν•΄λ‹Ή κ³„μ •μ΄ κ°€μ§„ μ΄λ”λ¥Ό μ μ–΄ν•  μ μλ‹¤. μ‚¬μ©μκ°€ μμ‹ μ κ°μΈν‚¤λ¥Ό μ•μ „ν•κ² μ μ§€ν•λ‹¤λ©΄, μ΄λ”λ¦¬μ›€ νΈλμ­μ…μ λ””μ§€ν„Έ μ„λ…μ€ κ°μΈν‚¤μ μ†μ κ¶μ„ μ¦λ…ν•κΈ° λ•λ¬Έμ— μκΈμ μ‹¤μ  μ†μ μμ„λ„ μ¦λ…ν•λ‹¤.

μ΄λ”λ¦¬μ›€μ—μ„ μ‚¬μ©ν•λ” κ²ƒκ³Ό κ°™μ€ κ³µκ°ν‚¤ μ•”νΈν™” κΈ°λ° μ‹μ¤ν…μ—μ„ ν‚¤λ” κ°μΈ(λΉ„λ°€)ν‚¤μ™€ κ³µκ°ν‚¤λ΅ κµ¬μ„±λ μμΌλ΅ μ κ³µν•λ‹¤. κ³µκ°ν‚¤λ” μ€ν–‰ κ³„μΆ λ²νΈμ™€, κ°μΈν‚¤λ” PIN(κ°μΈ μ‹λ³„ λ²νΈ)κ³Ό μ μ‚¬ν•λ‹¤κ³  μƒκ°ν•΄ λ³΄μ. ν›„μλ” κ³„μ •μ— λ€ν• μ μ–΄κ¶μ„ μ κ³µν•κ³ , μ „μλ¥Ό κ°€μ§€κ³  κ³„μ •μ„ μ‹λ³„ν•  μ μλ‹¤. κ°μΈν‚¤ μμ²΄λ” μ΄λ”λ¦¬μ›€ μ‚¬μ©μμ—κ² λ“λ¬λ‚λ” κ²½μ°κ°€ κ±°μ μ—†λ‹¤. λ€λ¶€λ¶„ μ•”νΈν™”λ ν•νƒλ΅ νΉμ νμΌμ— μ €μ¥ν•κ³ , μ΄λ”λ¦¬μ›€ μ§€κ°‘ μ†ν”„νΈμ›¨μ–΄λ΅ κ΄€λ¦¬ν•λ‹¤.

μ΄λ”λ¦¬μ›€ νΈλμ­μ…μ μ§€κΈ‰ λ¶€λ¶„μ—μ„ μ§€μ •λ μμ‹ μλ” μ΄λ”λ¦¬μ›€ μ£Όμ†λ΅ ν‘μ‹ν•λ©°, μ΄ μ£Όμ†λ” μ€ν–‰ μ†΅κΈμ μμµμ κ³„μΆ μ„Έλ¶€ μ •λ³΄μ™€ λ™μΌν• λ°©μ‹μΌλ΅ μ‚¬μ©ν•λ‹¤. μ΄ν›„μ— μμ„Έν λ³Ό μ μλ“―μ΄ μ™Έλ¶€ μ†μ  κ³„μ •μ μ΄λ”λ¦¬μ›€ μ£Όμ†λ” κ³µκ°ν‚¤-κ°μΈν‚¤ μμ κ³µκ°ν‚¤ λ¶€λ¶„μ—μ„ μƒμ„±λλ‹¤. κ·Έλ¬λ‚ λ¨λ“  μ΄λ”λ¦¬μ›€ μ£Όμ†κ°€ κ³µκ°ν‚¤-κ°μΈν‚¤ μμ„ λ‚νƒ€λ‚΄λ” κ²ƒμ€ μ•„λ‹λ‹¤. κ°μΈν‚¤λ΅ λ’·λ°›μΉ¨λμ§€ μ•λ” μ»¨νΈλ™νΈλ¥Ό ν‘μ‹ν•  μλ„ μλ‹¤.

## **2. κ³µκ°ν‚¤ μ•”νΈν™”μ™€ μ•”νΈν™”ν**

κ³µκ°ν‚¤ μ•”νΈν™”(λΉ„λ€μΉ­ μ•”νΈν™”λΌκ³ λ„ ν•¨)λ” μ¤λλ‚  μ •λ³΄ λ³΄μ•μ ν•µμ‹¬ μ”μ†λ‹¤. 1970λ…„λ€ λ§ν‹΄ ν—¬λ¨Ό(Martin Hellman), ν«ν•„λ“ λ””ν”Ό(Whitfield Diffie), λ„ν”„ λ¨Έν΄(Ralph Merkle)μ΄ μ²μ κ³µκ°ν• μ΄ κΈ°λ²•μ€ μ•”νΈν•™ λ¶„μ•Όμ—μ„ λ€μ¤‘μ κ΄€μ‹¬μ„ λ¶λ¬μΌμΌν‚¨ κΈ°λ…λΉ„μ μΈ λνκµ¬μ€λ‹¤. 70λ…„λ€ μ΄μ „μ—, μ •λ¶€λ” κ°•λ ¥ν• μ•”νΈν•™ μ§€μ‹μ„ λΉ„λ°€λ΅ μ μ§€ν–λ‹¤.

κ³µκ°ν‚¤ μ•”νΈν™”λ” κ³ μ ν• ν‚¤λ¥Ό μ‚¬μ©ν•μ—¬ μ •λ³΄λ¥Ό λ³΄νΈν•λ‹¤. μ΄ ν‚¤λ” νΉμν• μ†μ„±(κ³„μ‚°ν•κΈ°λ” μ‰½μ§€λ§ κ·Έ μ—­(inverse)μ„ κ³„μ‚°ν•κΈ°λ” μ–΄λ µλ‹¤)μ„ κ°€μ§„ μν•™ ν•¨μλ¥Ό λ°”νƒ•μΌλ΅ ν•λ‹¤. μ΄λ° ν•¨μλ¥Ό λ°”νƒ•μΌλ΅ν• μ•”νΈν™”λ” λ””μ§€ν„Έ λΉ„λ°€κ³Ό μ„μ΅° λ¶κ°€λ¥ν• λ””μ§€ν„Έ μ„λ…μ„ λ§λ“¤ μ μμΌλ©°, μ΄κ²ƒμ€ μν•™ λ²•μΉ™μ— μν•΄ λ³΄μ¥λ°›λ”λ‹¤.

μλ¥Ό λ“¤μ–΄, 2κ°μ ν° μ†μλ¥Ό κ³±ν•λ” κ²ƒμ€ μ•„μ£Ό κ°„λ‹¨ν•λ‹¤. κ·Έλ¬λ‚ 2κ°μ ν° μ†μμ κ³±μ„ κ°μ•ν•  λ• μ†μΈμ(`μ†μΈμ λ¶„ν•΄(prime factorization)`λΌκ³  ν•λ” λ¬Έμ )λ¥Ό μ°Ύλ” λ¬Έμ λ” λ§¤μ° μ–΄λ µλ‹¤. 8,018,009λΌλ” μ«μκ°€ λ‘ μ†μμ κ²°κ³ΌλΌκ³  μ μ‹ν–μ„ λ• κ·Έ λ‘ μ†μλ¥Ό μ°Ύλ” κ²ƒμ΄ 8,018,009λ¥Ό λ§λ“¤κΈ° μ„ν•΄ κ·Έ μ†μλ¥Ό κ³±ν•λ” κ²ƒλ³΄λ‹¤ ν›¨μ”¬ λ” μ–΄λ µλ‹¤.

μ΄λ° μν•™ ν•¨μ μ¤‘ μΌλ¶€λ” λΉ„λ°€ μ •λ³΄λ¥Ό μ•κ³  μμ„ λ• μ‰½κ² κ±°κΎΈλ΅ κ³„μ‚°ν•  μ μλ‹¤. μ•μ μμ—μ„ μ†μΈμ μ¤‘ ν•λ‚κ°€ 2,003μ΄λΌκ³  ν•λ©΄, κ°„λ‹¨ν λ‚λ¨Έμ§€ μ†μΈμλ¥Ό μ‰½κ² μ°Ύμ„ μ μλ‹¤(8,018,009 Γ· 2,003 = 4,003). μ΄λ° ν•¨μλ” μ—­μ‚°ν•κΈ° μ„ν• λ‹¨μ¶•ν‚¤λ΅ μ‚¬μ©ν•  μ μλ” λΉ„λ°€ μ •λ³΄κ°€ μ—†μΌλ©΄ κ±°κΎΈλ΅ κ³„μ‚°ν•κΈ° μ–΄λ µκΈ° λ•λ¬Έμ— `νΈλ© λ„μ–΄ ν•¨μ(trapdoor function)`λΌκ³ λ„ ν•λ‹¤.

μ•”νΈν™”μ— μ μ©ν• μν•™ ν•¨μμ μΆ€ λ” λ°μ „λ λ²”μ£Όλ” νƒ€μ› κ³΅μ„ μ μ‚°μ  μ—°μ‚°μ„ λ°”νƒ•μΌλ΅ ν•λ‹¤. νƒ€μ› κ³΅μ„  μ‚°μ μ—μ„ μ†μλ΅ λ‚λ λ‚λ¨Έμ§€λ¥Ό κ³±ν•λ” κ²ƒμ€ κ°„λ‹¨ν•μ§€λ§, λ‚λ—μ…(μ—­ν•¨μ)μ€ μ‚¬μ‹¤μƒ λ¶κ°€λ¥ν•λ‹¤. μ΄κ²ƒμ„ `μ΄μ‚° λ΅κ·Έ λ¬Έμ (discrete logarithm problem)`λΌκ³  ν•λ©°, ν„μ¬λ” μ•λ ¤μ§„ νΈλ© λ„μ–΄λ” μ—†λ‹¤. `νƒ€μ› κ³΅μ„  μ•”νΈν™”(elliptic curve cyptography)`λ” μµμ‹  μ»΄ν“¨ν„° μ‹μ¤ν…μ—μ„ κ΄‘λ²”μ„ν•κ² ν™μ©λλ©°, μ΄λ”λ¦¬μ›€(λ° κΈ°νƒ€ μ•”νΈν™”ν)μ—μ„ κ°μΈν‚¤μ™€ λ””μ§€ν„Έ μ„λ…μ„ μ‚¬μ©ν•λ” κΈ°μ΄κ°€ λλ‹¤.

> β€» νλ¥΄λ§μ λ§μ§€λ§‰ μ •λ¦¬λ¥Ό μ¦λ…ν•λ” κ³Όμ •μ—μ„ μ“°μ€λ νƒ€μ›κ³΅μ„ μ΄λ΅ μ€ ν„μ¬ μ‹¤μƒν™μ—μ„ μ•”νΈμ²΄κ³„λ΅μ¨ λ§μ΄ μ“°μ΄κ³  μλ‹¤. λ§κµ­μ κµ­κ°€ μ•λ³΄κµ­ NSAλ„ νƒ€μ›κ³΅μ„ μ•”νΈ λ°©μ‹μ„ μ±„νƒν•κ³  μλ‹¤. νƒ€μ›κ³΅μ„ μ•”νΈμ λ€ν‘μ μΈ μ¥μ μ€ κ³µκ°ν‚¤ μ•”νΈλ°©μ‹μ—μ„ κ³µκ°ν‚¤ λ³΄λ‹¤ μ§§μ€ ν‚¤λ΅μ¨ λΉ„μ·ν• μμ¤€μ μ•μ „μ„±μ„ μ κ³µν•λ‹¤λ” κ²ƒμ΄λ‹¤. λ•λ¬Έμ— μ „μ†΅λ‰μ΄λΌλκ°€ κ³„μ‚°λ‰μ΄ μ ν•λ λ¬΄μ„ ν™κ²½λ“¤μ—μ„ κ·Έ μ¥μ μ΄ λ¶€κ°λλ‹¤. κµν†µμΉ΄λ“, μ‹ μ©μΉ΄λ“, μλ£λ³΄ν—μ¦ λ“±μ΄ νƒ€μ›κ³΅μ„ μ•”νΈμ²΄κ³„λ¥Ό μ΄μ©ν•κ³  μκ³ , λΉ„νΈμ½”μΈ λν• νƒ€μ›κ³΅μ„ μ•”νΈ λ°©μ‹μΌλ΅λ¶€ν„° λ§λ“¤μ–΄μ§„ μ‹μ¤ν…μ΄λ‹¤.

> * [μ•”νΈν•™ WIKI](https://en.wikipedia.org/wiki/Cryptography)
> * [νΈλ© λ„μ–΄ ν•¨μ WIKI](https://en.wikipedia.org/wiki/Trapdoor_function)
> * [μ†μΈμ λ¶„ν•΄](https://en.wikipedia.org/wiki/Integer_factorization)
> * [μ΄μ‚° λ΅κ·Έ](https://en.wikipedia.org/wiki/Discrete_logarithm)
> * [νƒ€μ› κ³΅μ„  μ•”νΈν™”](https://en.wikipedia.org/wiki/Elliptic-curve_cryptography)

μ΄λ”λ¦¬μ›€μ—μ„λ” κ³µκ°ν‚¤ μ•”νΈν™”(λΉ„λ€μΉ­ μ•”νΈν™”λΌκ³ λ„ ν•¨)λ¥Ό μ‚¬μ©ν•μ—¬ μ΄ μ¥μ—μ„ μ„¤λ…ν• κ³µκ°ν‚¤-κ°μΈν‚¤ μμ„ λ§λ“ λ‹¤. κ³µκ°ν‚¤λ” κ°μΈν‚¤μ—μ„ νμƒλλ―€λ΅ 'μ'μΌλ΅ κ°„μ£Όν•λ‹¤. κ·Έμ™€ ν•¨κ», κ·Έ μμ€ κ³µκ°μ μΌλ΅ μ ‘κ·Όν•  μ μλ” κ³„μ • ν•Έλ“¤(μ£Όμ†)κ³Ό κ³„μ •μ μ΄λ”μ— λ€ν• μ ‘κ·Ό κ¶ν•, κ·Έλ¦¬κ³  μ¤λ§νΈ μ»¨νΈλ™νΈλ¥Ό μ‚¬μ©ν•  λ• κ³„μ •μ΄ ν•„μ”λ΅ ν•λ” λ¨λ“  μΈμ¦μ— λ€ν• μ‚¬μ  μ μ–΄κ¶μ„ μ κ³µν•¨μΌλ΅μ¨ μ΄λ”λ¦¬μ›€ κ³„μ •μ„ λ‚νƒ€λ‚Έλ‹¤. κ°μΈν‚¤λ” κ³„μ •μ—μ„ μκΈμ„ μ§€μ¶ν•κΈ° μ„ν•΄ νΈλμ­μ…μ— μ„λ…ν•΄μ•Ό ν•λ” `λ””μ§€ν„Έ μ„λ…(digital signature)`μ„ λ§λ“λ” λ° ν•„μ”ν• κ³ μ ν• μ •λ³΄μ μ ‘κ·Όμ„ μ μ–΄ν•λ‹¤. λ””μ§€ν„Έ μ„λ…μ€ μ†μ μ λλ” μ»¨νΈλ™νΈ μ‚¬μ©μλ¥Ό μΈμ¦ν•λ” λ°λ„ μ‚¬μ©ν•λ‹¤.

> λ€λ¶€λ¶„μ μ§€κ°‘ κµ¬ν„μ—μ„ κ°μΈν‚¤μ™€ κ³µκ°ν‚¤λ” νΈμμƒ ν‚¤ μ(key pair)μΌλ΅ ν•¨κ» μ €μ¥ν•λ‹¤. κ·Έλ¬λ‚ κ³µκ°ν‚¤λ” κ°μΈν‚¤λ΅λ¶€ν„° κ°„λ‹¨ν κ³„μ‚°λ  μ μμΌλ―€λ΅ κ°μΈν‚¤λ§ μ €μ¥ν•λ” κ²ƒλ„ κ°€λ¥ν•λ‹¤.

λ””μ§€ν„Έ μ„λ…μ„ λ§λ“¤μ–΄ λ¨λ“  λ©”μ‹μ§€μ— μ„λ…ν•  μ μλ‹¤. μ΄λ”λ¦¬μ›€ νΈλμ­μ…μ—μ„λ” νΈλμ­μ… μμ²΄μ μ„Έλ¶€μ‚¬ν•­μ΄ λ©”μ‹μ§€λ΅ μ‚¬μ©λλ‹¤. μ•”νΈ μν•™(μ΄λ² μλ” νƒ€μ› κ³΅μ„  μ•”νΈν™”)μ€ λ©”μ‹μ§€(μ¦‰, νΈλμ­μ… μ„Έλ¶€ μ •λ³΄)λ¥Ό κ°μΈν‚¤μ™€ κ²°ν•©ν•μ—¬ κ°μΈν‚¤λ¥Ό μ•μ•„μ•Όλ§ λ§λ“¤ μ μλ” μ½”λ“ μƒμ„± λ°©λ²•μ„ μ κ³µν•λ‹¤. μ΄ μ½”λ“λ¥Ό λ””μ§€ν„Έ μ„λ…μ΄λΌκ³  ν•λ‹¤. μ΄λ”λ¦¬μ›€ νΈλμ­μ…μ€ κΈ°λ³Έμ μΌλ΅ νΉμ • μ΄λ”λ¦¬μ›€ μ£Όμ†λ΅ νΉμ • κ³„μ •μ— μ ‘κ·Όν•λ” μ”μ²­μ΄λ‹¤. μκΈμ„ μ΄λ™ν•κ±°λ‚ μ¤λ§νΈ μ»¨νΈλ™νΈμ™€ μƒνΈμ‘μ©ν•κΈ° μ„ν•΄ νΈλμ­μ…μ„ μ΄λ”λ¦¬μ›€ λ„¤νΈμ›ν¬λ΅ λ³΄λ‚΄λ©΄, λ¬Έμ μ μ΄λ”λ¦¬μ›€ μ£Όμ†μ— ν•΄λ‹Ήν•λ” κ°μΈν‚¤λ΅ μƒμ„±λ λ””μ§€ν„Έ μ„λ…λ„ ν•¨κ» λ³΄λ‚΄μ•Ό ν•λ‹¤. νƒ€μ› κ³΅μ„  μν•™μ΄λ€ λ””μ§€ν„Έ μ„λ…, νΈλμ­μ… μ„Έλ¶€ μ •λ³΄, μ ‘κ·Όν•λ ¤λ” μ΄λ”λ¦¬μ›€ μ£Όμ†κ°€ μΌμΉν•λ”μ§€ ν™•μΈν•μ—¬ 'λ„κµ¬λ‚' νΈλμ­μ…μ΄ μ ν¨ν•μ§€ ν™•μΈν•  μ μμμ„ μλ―Έν•λ‹¤. μ΄λ¬ν• ν™•μΈ κ³Όμ •μ—λ” κ°μΈν‚¤κ°€ μ „ν€ ν¬ν•¨λμ§€ μ•λ”λ‹¤. κ°μΈν‚¤λ” κ°μΈ μμ—­μ— λ‚¨μ•„ μλ‹¤. κ·Έλ¬λ‚ κ²€μ¦ ν”„λ΅μ„Έμ¤μ—μ„λ” μμ‹¬μ μ—¬μ§€ μ—†μ΄ κ·Έ νΈλμ­μ…μ΄ κ³µκ°ν‚¤μ— λ€μ‘λλ” κ°μΈν‚¤λ¥Ό κ°€μ§„ μ‚¬λμ— μν•΄ λ§λ“¤μ–΄μ΅μμ„ ν™•μ¦ν•  μ μλ‹¤. μ΄κ²ƒμ΄ κ³µκ°ν‚¤ μ•”νΈν™”μ 'λ§λ²•'μ΄λ‹¤.

> μ΄λ”λ¦¬μ›€ ν”„λ΅ν† μ½μ—λ” μ•”νΈν™”κ°€ μ—†κΈ° λ•λ¬Έμ—, μ΄λ”λ¦¬μ›€ λ„¤νΈμ›ν¬ λ™μ‘μ μΌλ¶€λ΅ λ³΄λ‚΄λ” λ¨λ“  λ©”μ‹μ§€λ” λ¨λ“  μ‚¬λμ΄ (λ¶κ°€ν”Όν•κ²) μ½μ„ μ μλ‹¤. λ”°λΌμ„ κ°μΈν‚¤λ” νΈλμ­μ… μΈμ¦μ„ μ„ν• λ””μ§€ν„Έ μ„λ…μ„ λ§λ“λ” λ°μ—λ§ μ‚¬μ©ν•λ‹¤.

## **3. κ°μΈν‚¤**

κ°μΈν‚¤λ” λ‹¨μν λ¬΄μ‘μ„λ΅ μ„ νƒν• μ«μλ‹¤. κ°μΈν‚¤μ μ†μ κ¶κ³Ό μ μ–΄λ” ν•΄λ‹Ή μ£Όμ†λ¥Ό μΉμΈν•λ” μ»¨νΈλ™νΈμ— λ€ν• μ ‘κ·ΌλΏλ§ μ•„λ‹λΌ ν•΄λ‹Ή μ΄λ”λ¦¬μ›€ μ£Όμ†μ™€ κ΄€λ ¨λ λ¨λ“  μκΈμ— λ€ν• μ‚¬μ©μ μ μ–΄μ κ·Όμ›μ΄λ‹¤. κ°μΈν‚¤λ” νΈλμ­μ…μ— μ“°μ΄λ” μκΈμ μ†μ κ¶μ„ μ¦λ…ν•¨μΌλ΅μ¨ μ΄λ”λ¥Ό μ†λΉ„ν•λ”λ° ν•„μ”ν• μ„λ…μ„ λ§λ“λ” λ° μ‚¬μ©λλ‹¤. κ°μΈν‚¤λ” ν•­μƒ λΉ„λ°€λ΅ μ μ§€ν•΄μ•Ό ν•λ‹¤. μ™λƒν•λ©΄ κ°μΈν‚¤λ¥Ό μ 3μμ—κ² κ³µκ°ν•λ” ν–‰μ„λ” κ°μΈν‚¤λ΅ ν™•λ³΄ν• μ»¨νΈλ™νΈμ™€ μ΄λ”μ— λ€ν• μ μ–΄ κ¶ν•μ„ μ 3μμ—κ² λ¶€μ—¬ν•λ” κ²ƒμ΄λ‚ λ§μ°¬κ°€μ§€μ΄κΈ° λ•λ¬Έμ΄λ‹¤. κ°μΈν‚¤λ” λ°λ“μ‹ λ°±μ—…ν•μ—¬ μ°λ°μ μΈ μ†μ‹¤λ΅λ¶€ν„° λ³΄νΈν•΄μ•Ό ν•λ‹¤. ν•λ² μƒμ–΄λ²„λ¦¬λ©΄ λμ°Ύμ„ μ μ—†μΌλ©°, ν•΄λ‹Ή ν‚¤λ΅ ν™•λ³΄ν• μκΈλ„ μμ›ν μƒμ–΄λ²„λ¦¬κ² λλ‹¤.

> μ΄λ”λ¦¬μ›€ κ°μΈν‚¤λ” μ«μλ‹¤. λΉ„κ³µκ°ν‚¤λ¥Ό λ¬΄μ‘μ„λ΅ μ„ νƒν•λ” λ°©λ²• μ¤‘ ν•λ‚λ” λ™μ „, μ—°ν•„, μΆ…μ΄λ¥Ό μ‚¬μ©ν•λ” κ²ƒμ΄λ‹¤. λ™μ „μ„ 256λ² λμ Έμ„ μ΄λ”λ¦¬μ›€ μ§€κ°‘μ—μ„ μ‚¬μ©ν•  μ μλ” 2μ§„μλ΅ λ μ„μμ κ°μΈν‚¤λ¥Ό μ–»μ„ μ μλ‹¤. κ³µκ°ν‚¤μ™€ μ£Όμ†λ” μ΄ κ°μΈν‚¤λ΅λ¶€ν„° μƒμ„±λ  μ μλ‹¤.

### **3-1. λ‚μλ΅ κ°μΈν‚¤ μƒμ„±**

ν‚¤λ¥Ό μƒμ„±ν•λ” κ°€μ¥ μ¤‘μ”ν• μ²« λ²μ§Έ λ‹¨κ³„λ” μ—”νΈλ΅ν”Ό, μ¦‰ λ¬΄μ‘μ„μ„±μ„ ν™•λ³΄ν•λ” κ²ƒμ΄λ‹¤. μ΄λ”λ¦¬μ›€ κ°μΈν‚¤λ¥Ό μƒμ„±ν•λ” κ²ƒμ€ κΈ°λ³Έμ μΌλ΅ 1μ—μ„ 2^256 μ‚¬μ΄μ μ«μλ¥Ό μ„ νƒν•λ” κ²ƒμ΄λΌκ³  λ³Ό μ μλ‹¤. ν•΄λ‹Ή λ²νΈλ¥Ό μ„ νƒν•λ” κ²ƒμ΄ μμΈ΅ κ°€λ¥ν•κ±°λ‚ κ²°μ •μ μ΄λΌλ©΄ μ΄ λ²νΈ μ„ νƒ λ°©λ²•μ€ μ¤‘μ”ν•΄μ§„λ‹¤. μ΄λ”λ¦¬μ›€ μ†ν”„νΈμ›¨μ–΄λ” κΈ°λ³Έ μ΄μμ²΄μ μ λ‚μ μƒμ„±κΈ°λ¥Ό μ‚¬μ©ν•μ—¬ 256κ°μ μ„μ λΉ„νΈλ¥Ό μƒμ„±ν•λ‹¤. μΌλ°μ μΌλ΅ OS λ‚μ μƒμ„±κΈ°λ” μ‚¬λμ΄ λ¬΄μ‘μ„μ μ†μ¤κ°€ λμ–΄ μ΄κΈ°ν™”λλ―€λ΅ λ‡ μ΄ λ™μ• λ§μ°μ¤λ¥Ό μ›€μ§μ΄κ±°λ‚ ν‚¤λ³΄λ“μ—μ„ μ„μμ ν‚¤λ¥Ό λ„λ¥΄λΌλ” μ”μ²­μ„ λ°›μ„ μ μλ‹¤. μ»΄ν“¨ν„°μ λ§μ΄ν¬λ΅ν° μ±„λ„μ—μ„ λ‚μ¤λ” μ°μ£Ό λ°©μ‚¬μ„  λ…Έμ΄μ¦κ°€ λ€μ•μ΄ λ  μ μλ‹¤.

μΆ€ λ” μ •ν™•ν λ§ν•μλ©΄, κ°μΈν‚¤λ” 2^256λ³΄λ‹¤ μ•½κ°„ μ‘μ€ 0μ΄ μ•„λ‹ λ§¤μ° ν° μ«μ(κ±°λ€ν• 78μλ¦¬ μ«μ, λ€λµ 1.158 x 10^77)κΉμ§€ κ°€λ¥ν•λ‹¤. μ •ν™•ν• μ«μλ” μ²« λ²μ§Έ 38μλ¦¬λ¥Ό 2^256μΌλ΅ κ³µμ ν•λ©°, μ΄λ”λ¦¬μ›€μ—μ„ μ‚¬μ©λ νƒ€μ› κ³΅μ„  μμ„λ΅ μ •μν•λ‹¤. λΉ„κ³µκ° ν‚¤λ¥Ό μƒμ„±ν•κΈ° μ„ν•΄ 256λΉ„νΈ μ«μλ¥Ό λ¬΄μ‘μ„λ΅ μ¶”μ¶ν•μ—¬ μ ν¨ν• λ²”μ„ λ‚΄μ— μλ”μ§€ ν™•μΈν•λ‹¤. ν”„λ΅κ·Έλλ° μΈ΅λ©΄μ—μ„ μ΄κ²ƒμ€ μΌλ°μ μΌλ΅ λ” ν° μ„μμ λΉ„νΈ λ¬Έμμ—΄(μ•”νΈν•™μ μΌλ΅ μ•μ „ν• μ„μμ„± μ†μ¤μ—μ„ μμ§‘λ¨)μ„ Keccak-256 λλ” SHA-256 κ°™μ€ 256λΉ„νΈ ν•΄μ‹ μ•κ³ λ¦¬μ¦μ— κ³µκΈ‰ν•¨μΌλ΅μ¨ μ΄λ£¨μ–΄ μ§„λ‹¤. λ‘ κ°€μ§€ μ•κ³ λ¦¬μ¦ λ¨λ‘ νΈλ¦¬ν•κ² 256λΉ„νΈ μλ¥Ό μƒμ„±ν•λ‹¤. κ²°κ³Όκ°€ μ ν¨ν• λ²”μ„ λ‚΄μ— μμΌλ©΄ μ μ ν• κ°μΈν‚¤κ°€ λλ‹¤. κ·Έλ ‡μ§€ μ•μΌλ©΄ λ‹¤λ¥Έ μ„μμ μ«μλ΅ λ‹¤μ‹ μ‹λ„ν•κΈ°λ§ ν•λ©΄ λλ‹¤.

 > 2^256(μ΄λ”λ¦¬μ›€ κ°μΈν‚¤ κ³µκ°„ ν¬κΈ°)μ€ λ€λ‹¨ν ν° μ«μλ‹¤. 10μ§„μλ΅ μ•½ 10^77, μ¦‰ 77μλ¦¬ μ«μλ‹¤. λΉ„κµλ¥Ό ν•΄λ³΄μλ©΄, μ°λ¦¬κ°€ λ³΄λ” μ°μ£Όλ” 10^80κ°μ μ›μλ¥Ό ν¬ν•¨ν•λ” κ²ƒμΌλ΅ μ¶”μ •λλ‹¤. λ”°λΌμ„ μ°μ£Όμ— μλ” λ¨λ“  μ›μμ— μ΄λ”λ¦¬μ›€ κ³„μ •μ„ μ κ³µν•κΈ°μ— μ¶©λ¶„ν•  λ§νΌμ κ°μΈν‚¤κ°€ μλ‹¤. ν•λ‚μ κ°μΈν‚¤λ¥Ό λ¬΄μ‘μ„λ΅ μ„ νƒν–μ„ λ•, λ„κµ°κ°€κ°€ κ·Έκ²ƒμ„ μ¶”μΈ΅ν•κ±°λ‚ μ¤μ¤λ΅ κ°™μ€ κ°’μ„ μ„ νƒν•  μ μλ” κ°€λ¥ν• λ°©λ²•μ€ ν„μ¬ μ—†λ‹¤.

 κ°μΈν‚¤ μƒμ„± ν”„λ΅μ„Έμ¤λ” μ¤ν”„λΌμΈ ν”„λ΅μ„Έμ¤λ‹¤. κ·Έκ²ƒμ€ μ΄λ”λ¦¬μ›€ λ„¤νΈμ›ν¬μ™€μ ν†µμ‹ μ΄λ‚ λ‹¤λ¥Έ μ‚¬λκ³Όμ ν†µμ‹ μ„ ν•„μ”λ΅ ν•μ§€ μ•λ”λ‹¤. λ”°λΌμ„ μ•„λ¬΄λ„ μ„ νƒν•  μ μ—†λ” μ«μλ¥Ό μ„ νƒν•λ ¤λ©΄ κ·Έκ²ƒμ€ μ •λ§λ΅ λ¬΄μ‘μ„μ μ΄μ–΄μ•Ό ν•λ‹¤. λ§μ•½ μ—¬λ¬λ¶„μ΄ μ§μ ‘ κ·Έ λ²νΈλ¥Ό μ„ νƒν•λ‹¤λ©΄, λ‹¤λ¥Έ μ‚¬λμ΄ κ·Έκ²ƒμ„ μ‹λ„ν•΄μ„ κ°™μ€ λ²νΈλ¥Ό μ°Ύμ„ μ μλ” ν™•λ¥ μ΄ λ„λ¬΄ λ†’λ‹¤. λ‚μ λ‚μ μƒμ„±κΈ°(λ€λ¶€λ¶„μ ν”„λ΅κ·Έλλ° μ–Έμ–΄μ— μλ” μμ‚¬ λ‚μ rand ν•¨μμ™€ κ°™μ€)λ¥Ό μ‚¬μ©ν•λ” κ²ƒμ€ λ³µμ ν•κΈ°κ°€ ν›¨μ”¬ λ” μ‰½κΈ° λ•λ¬Έμ— λ” λ‚μλ‹¤. μ¨λΌμΈ κ³„μ •μ μ•”νΈμ™€ λ§μ°¬κ°€μ§€λ΅ κ°μΈν‚¤λ„ μ¶”μΈ΅ν•  μ μ—†μ–΄μ•Ό ν•λ‹¤. λ‹¤ν–‰νλ„ κ°μΈν‚¤λ¥Ό κΈ°μ–µν•  ν•„μ”κ°€ μ—†μΌλ―€λ΅ κ°€λ¥ν• ν• μµμ„ μ μ ‘κ·Ό λ°©μ‹μ„ μ·¨ν•  μ μλ‹¤. μ¦‰, μ§„μ •ν• λ¬΄μ‘μ„μ„±μ΄λ‹¤.

 > μ„μμ μ«μλ¥Ό λ§λ“¤κ±°λ‚ ν”„λ΅κ·Έλλ° μ–Έμ–΄μ—μ„ μ κ³µν•λ” 'κ°„λ‹¨ν•' λ‚μ μƒμ„±κΈ°λ¥Ό μ‚¬μ©ν•λ” μ½”λ“λ” μ‘μ„±ν•μ§€ λ§λΌ. μ¶©λ¶„ν• μ—”νΈλ΅ν”Ό μ›μ²μ μ‹λ“(seed)μ™€ ν•¨κ» μ•”νΈλ΅ μ•μ „ν• μμ‚¬ λ‚μ μƒμ„±κΈ°(μ: CSPRNG)λ¥Ό μ‚¬μ©ν•λ” κ²ƒμ΄ μ¤‘μ”ν•λ‹¤. μ•”νΈλ΅ λ³΄νΈλμ–΄ μλ”μ§€ ν™•μΈν•κΈ° μ„ν•΄ μ‚¬μ©ν•κ³ μ ν•λ” λ‚μ μƒμ„±κΈ° λΌμ΄λΈλ¬λ¦¬μ λ¬Έμ„λ¥Ό ν•™μµν•λΌ. CSPRNG λΌμ΄λΈλ¬λ¦¬μ μ¬λ°”λ¥Έ κµ¬ν„μ€ ν‚¤ λ³΄μ•μ— μ¤‘μ”ν•λ‹¤.

 λ‹¤μμ€ μ„μλ΅ μƒμ„±ν• 16μ§„μ ν•μ‹μ κ°μΈν‚¤λ‹¤(256λΉ„νΈλ” 64λΉ„νΈ 16μ§„μλ΅ ν‘μ‹, κ° 4λΉ„νΈ).

 ```
 f8f8a2f43c8376ccb0871305060d7b27b0554d2cc72bccf41b2705608452f315
 ```

## **4. κ³µκ°ν‚¤**

μ΄λ”λ¦¬μ›€ κ³µκ°ν‚¤λ” νƒ€μ› κ³΅μ„ μ— μλ” `μ (point)`μΌλ΅ νƒ€μ› κ³΅μ„  λ°©μ •μ‹μ„ λ§μ΅±ν•λ” xμ™€ y μΆν‘μ μ§‘ν•©μ„ μλ―Έν•λ‹¤.

λ” κ°„λ‹¨ν• μ©μ–΄λ΅, μ΄λ”λ¦¬μ›€ κ³µκ°ν‚¤λ” ν•¨κ» κ²°ν•©λ 2κ°μ μ«μλ‹¤. μ΄ μ«μλ” κ°μΈν‚¤λ΅λ¶€ν„° `λ‹¨λ°©ν–¥μΌλ΅λ§` κ³„μ‚°ν•  μ μλ‹¤. μ¦‰, κ°μΈν‚¤κ°€ μλ” κ²½μ° κ³µκ°ν‚¤λ¥Ό κ³„μ‚°ν•κΈ°λ” μ‰½μ§€λ§, κ³µκ°ν‚¤μ—μ„ κ°μΈν‚¤λ¥Ό κ³„μ‚°ν•  μλ” μ—†λ‹¤.

κ³µκ°ν‚¤λ” μ‚¬μ‹¤μƒ λΉ„κ°€μ—­μ μΈ νƒ€μ› κ³΅μ„  κ³±μ…μ„ μ‚¬μ©ν•μ—¬ κ°μΈν‚¤λ΅λ¶€ν„° κ³„μ‚°λλ‹¤. `K = k * G`, μ—¬κΈ°μ„ kλ” κ°μΈν‚¤, `G`λ” `μƒμ„±μ μ (generator point)`μ΄λΌκ³  λ¶λ¦¬λ” μƒμμ , `K`λ” κ²°κ³Όλ΅ λ‚μ¤λ” κ³µκ°ν‚¤, `*`λ” νΉμ νƒ€μ› κ³΅μ„  κ³±ν•κΈ° μ—°μ‚°μλ‹¤. νƒ€μ› κ³΅μ„ μ„ μΌλ°μ μΈ κ³°μ…κ³Ό κ°™μ§€ μ•λ‹¤. μΌλ°μ μΈ κ³±μ…κ³Ό κΈ°λ¥μ  μ†μ„±μ„ κ³µμ ν•μ§€λ§ κ·Έκ²ƒλΏμ΄λ‹¤. μλ¥Ό λ“¤μ–΄, 'μ΄μ‚° λ΅κ·Έ μ°ΎκΈ°'(Kλ¥Ό μ•κ³  μλ” κ²½μ° kλ¥Ό κ³„μ‚°ν•λ‹¤)λ΅ μ•λ ¤μ§„ μ—­ μ—°μ‚°(μ •μƒ μμ— λ€ν• λ‚λ—μ…)μ€ κ°€λ¥ν• λ¨λ“  `k`κ°’μ„ μ‹λ„ν•λ” κ²ƒλ§νΌ μ–΄λ µλ‹¤(μ°μ£Όκ°€ ν—μ©ν•λ” κ²ƒλ³΄λ‹¤ λ” λ§μ€ μ‹κ°„μ΄ κ±Έλ¦¬λ” λ¬΄μ°¨λ³„ λ€μ… νƒμƒ‰).

κ°„λ‹¨ν λ§ν•λ©΄, νƒ€μ› κ³΅μ„ μ— λ€ν• μ‚°μ  μ—°μ‚°μ€ 'μ •κ·'μ •μ μ—°μ‚°κ³Ό λ‹¤λ¥΄λ‹¤. μ (G)μ— μ •μ(k)λ¥Ό κ³±ν•μ—¬ λ‹¤λ¥Έ μ (K)μ„ μƒμ„±ν•  μ μλ‹¤. κ·Έλ¬λ‚ λ‚λ—μ…(division)κ°™μ€ μ—°μ‚°μ΄ μ΅΄μ¬ν•μ§€ μ•μΌλ―€λ΅ κ³µκ°ν‚¤ Kλ¥Ό Gμ μΌλ΅ κ°„λ‹¨ν 'λ‚λ„μ–΄μ„' κ°μΈν‚¤ kλ¥Ό κ³„μ‚°ν•  μ μ—†λ‹¤. μ΄κ²ƒμ΄ λ‹¨λ°©ν–¥ μν•™ ν•¨μλ‹¤.

> νƒ€μ› κ³΅μ„  κ³±μ…μ€ μ•”νΈν•™μκ°€ 'λ‹¨λ°©ν–¥'ν•¨μλΌκ³  λ¶€λ¥΄λ” ν•¨μ μ ν•μ΄λ‹¤. ν• λ°©ν–¥(κ³±ν•κΈ°)μΌλ΅λ” μν–‰ν•κΈ° μ‰½κ³  λ°λ€ λ°©ν–¥(λ‚λ„κΈ°)μΌλ΅λ” μν–‰ν•κΈ°κ°€ μ‰½μ§€ μ•λ‹¤. κ°μΈν‚¤μ μ†μ μλ” μ•„λ¬΄λ„ ν•¨μλ¥Ό λλλ ¤μ„ κ³µκ°ν‚¤μ—μ„ κ°μΈν‚¤λ¥Ό κ³„μ‚°ν•  μ μ—†λ‹¤λ” κ²ƒμ„ μ•κ³  κ³µκ°ν‚¤λ¥Ό μ‰½κ² μƒμ„±ν•μ—¬ μ„Έμƒκ³Ό κ³µμ ν•  μ μλ‹¤. μ΄ μν•™μ  νΈλ¦­μ€ μ΄λ”λ¦¬μ›€ μκΈμ μ†μ κ¶κ³Ό κ³„μ•½ κ΄€λ¦¬λ¥Ό μ…μ¦ν•λ” μ„μ΅° λ¶κ°€λ¥ν•κ³  μ•μ „ν• λ””μ§€ν„Έ μ„λ…μ κΈ°μ΄κ°€ λλ‹¤.

### **4-1. νƒ€μ› κ³΅μ„  μ•”νΈν™” μ„¤λ…**

νƒ€μ› κ³΅μ„  μ•”νΈν™”λ” νƒ€μ› κ³΅μ„ μ μ μ— λ”ν•κΈ°μ™€ κ³±μ…μΌλ΅ ν‘ν„λλ” μ΄μ‚° λ€μ λ¬Έμ λ¥Ό λ°”νƒ•μΌλ΅ ν• λΉ„λ€μΉ­ λλ” κ³µκ°ν‚¤ μ•”νΈν™” μ ν•μ΄λ‹¤.

[κ·Έλ¦Ό 4-1]μ€ μ΄λ”λ¦¬μ›€μ—μ„ μ‚¬μ©ν•λ” κ²ƒκ³Ό λΉ„μ·ν• νƒ€μ› κ³΅μ„ μ ν• μλ‹¤.

> μ΄λ”λ¦¬μ›€μ€ λΉ„νΈμ½”μΈμ²λΌ secp256k1μ΄λΌλ” μ •ν™•ν• νƒ€μ› κ³΅μ„ μ„ μ‚¬μ©ν•λ‹¤. λ”°λΌμ„ λΉ„νΈμ½”μΈμ νƒ€μ› κ³΅μ„  λΌμ΄λΈλ¬λ¦¬ λ° λ„κµ¬λ¥Ό μ¬μ‚¬μ©ν•  μ μλ‹¤.

**[κ·Έλ¦Ό 4-1] νƒ€μ› κ³΅μ„ μ μ‹κ°ν™”**

![](https://images.velog.io/images/dogfootbirdfoot/post/1d7719df-eec7-4620-8b12-b8a8d7dcbb3f/%E1%84%80%E1%85%B3%E1%84%85%E1%85%B5%E1%86%B71.png)

μ΄λ”λ¦¬μ›€μ€ `λ―Έκµ­ ν‘μ¤€κΈ°μ μ—°κµ¬μ†(National Institute of Standards and Technology, NIST)`μ—μ„ μ μ •ν• `secp256k1`μ΄λΌλ” ν‘μ¤€μ— μ •μν• λ€λ΅ νΉμ • νƒ€μ› κ³΅μ„ κ³Ό μν•™ μƒμ μ§‘ν•©μ„ μ‚¬μ©ν•λ‹¤.

`secp256k1` κ³΅μ„ μ€ νƒ€μ› κ³΅μ„ μ„ μƒμ„±ν•λ” λ‹¤μ ν•¨μλ΅ μ •μν•λ‹¤.

`y^2 = (x^3 + 7)over(π”½ p)`

λλ”

`y^2 mod p = (x^3 + 7) mod p`

`mod p`(μ†μ pλ΅ λ‚λ λ‚λ¨Έμ§€)λ” μ΄ κ³΅μ„ μ΄ `π”½ p`λΌκ³  μ“°μΈ μ†μ μ°¨μ `p`μ μ ν•μ²΄μƒμ— μμμ„ λ‚νƒ€λ‚Έλ‹¤. μ—¬κΈ°μ„ `p = 2^256 β€“ 2^32 β€“ 2^9 β€“ 2^8 β€“ 2^7 β€“ 2^6 β€“ 2^4 β€“ 1`λ΅, λ§¤μ° ν° μ†μλ‹¤.

μ΄ κ³΅μ„ μ€ μ‹¤μ λ€μ‹ μ— μ†μ μ„μμ μ ν•μ²΄μƒμ— μ •μν–κΈ° λ•λ¬Έμ— 2μ°¨μ›μΌλ΅ ν©μ–΄μ Έ μλ” μ λ“¤μ ν¨ν„΄μ²λΌ λ³΄μΈλ‹¤. κ·Έλμ„ μ‹κ°ν™”ν•κΈ° μ–΄λ µλ‹¤. κ·Έλ¬λ‚ μν•™μ€ μ‹¤μμ— λ€ν• νƒ€μ› κ³΅μ„  μν•™κ³Ό λ™μΌν•λ‹¤. μλ¥Ό λ“¤μ–΄, [κ·Έλ¦Ό 4-2]μ—μ„ λ³΄μ—¬μ£Όλ” μΆν‘ μ„μ μ  ν¨ν„΄μ€ ν›¨μ”¬ μ‘μ€ μ ν•μ²΄μΈ μ†μ μ„μ 17μ νƒ€μ› κ³΅μ„ κ³Ό λ™μΌν•λ‹¤. `secp256k1` μ΄λ”λ¦¬μ›€ νƒ€μ› κ³΅μ„ μ€ ν—¤μ•„λ¦΄ μ μ—†μ„ λ§νΌ ν° μΆν‘μ—μ„ ν›¨μ”¬ λ” λ³µμ΅ν• μ  ν¨ν„΄μΌλ΅ μƒκ°ν•  μ μλ‹¤.

**[κ·Έλ¦Ό 4-2] νƒ€μ› κ³΅μ„  μ•”νΈν™” : p = 17μΌ λ• F(p)μ—μ„ νƒ€μ› κ³΅μ„ μ„ μ‹κ°ν™”**

![](https://images.velog.io/images/dogfootbirdfoot/post/92bfb01a-60fa-4eef-b4f9-e6d1fcc58d2b/%E1%84%80%E1%85%B3%E1%84%85%E1%85%B5%E1%86%B72.png)

μλ¥Ό λ“¤μ–΄, λ‹¤μμ€ `secp256k1` κ³΅μ„ μƒμ μ μΈ (x, y)λ¥Ό κ°–λ” μ  Qμ΄λ‹¤.

```
Q =
(49790390825249384486033144355916864607616083520101638681403973749255924539515,
59574132161899900045862086493921015780032175291755807399284007721050341297360)
```

[μμ  4-1]μ€ νμ΄μ¬μ„ μ‚¬μ©ν•μ—¬ μ§μ ‘ ν™•μΈν•λ” λ°©λ²•μ΄λ‹¤. λ³€μ xμ™€ yλ” μ•μ μμ™€ κ°™μ΄ μ  Qμ μΆν‘λ‹¤. λ³€μ pλ” νƒ€μ› κ³΅μ„ μ μ†μ(λ¨λ“  λ¨λ“λ΅ μ—°μ‚°μ— μ‚¬μ©λλ” μ†μ)λ‹¤. νμ΄μ¬μ λ§μ§€λ§‰ μ¤„μ€ νƒ€μ› κ³΅μ„  λ°©μ •μ‹μ΄λ‹¤(νμ΄μ¬μ % μ—°μ‚°μλ” λ¨λ“λ¬ μ—°μ‚°μλ‹¤). xμ™€ yκ°€ μ‹¤μ λ΅ νƒ€μ› κ³΅μ„ μƒμ ν• μ μ μΆν‘λΌλ©΄, κ·Έλ“¤μ€ λ°©μ •μ‹μ„ λ§μ΅±ν•κ³  κ²°κ³Όλ” 0μ΄λ‹¤(0Lμ€ κ°’μ΄ 0μ΄ κΈ΄ μ •μμ„). μ»¤λ§¨λ“λΌμΈμ— `python`μ„ μ…λ ¥ν•κ³  λ©λ΅μ—μ„ κ° μ¤„μ„ (>>> ν”„λ΅¬ν”„νΈ λ‹¤μμ—) λ³µμ‚¬ν•μ—¬ μ§μ ‘ ν•΄λ³΄μ.

**[μμ  4-1] νμ΄μ¬μ„ μ‚¬μ©ν•μ—¬ μ΄ μ μ΄ νƒ€μ› κ³΅μ„ μ— μμμ„ ν™•μΈν•¨**

```bash
Python 3.4.0 (default, Mar 30 2014, 19:23:13)
[GCC 4.2.1 Compatible Apple LLVM 5.1 (clang-503.0.38)] on darwin
Type "help", "copyright", "credits" or "license" for more information.
>>> p = 115792089237316195423570985008687907853269984665640564039457584007908834 \
671663
>>> x = 49790390825249384486033144355916864607616083520101638681403973749255924539515
>>> y = 59574132161899900045862086493921015780032175291755807399284007721050341297360
>>> (x ** 3 + 7 - y**2) % p
0L
```

### **4-2. νƒ€μ› κ³΅μ„  μ‚°μ  μ—°μ‚°**

λ§μ€ νƒ€μ› κ³΅μ„  μν•™μ€ μ°λ¦¬κ°€ ν•™κµμ—μ„ λ°°μ΄ μ •μ μ‚°μ κ³Ό λ§¤μ° ν΅μ‚¬ν•λ‹¤. νΉν μ°λ¦¬λ” λ”ν•κΈ° μ—°μ‚°μλ¥Ό μ •μν•  μ μλ‹¤. μ΄ μ—°μ‚°μλ” μ«μ μ„ μ„ λ”°λΌ μ ν”„ν•λ” λ€μ‹  κ³΅μ„ μ λ‹¤λ¥Έ μ μΌλ΅ μ ν”„ν•λ‹¤. μΌλ‹¨ μ°λ¦¬κ°€ λ§μ… μ—°μ‚°μλ¥Ό κ°€μ§€λ©΄, μ μ μ •μμ κ³±μ…μ„ μ •μν•  μ μλ‹¤. μ΄κ²ƒμ€ λ°λ³µλλ” λ§μ…κ³Ό κ°™λ‹¤.

νƒ€μ› κ³΅μ„ μ— λ‘ μ  P1κ³Ό P2κ°€ μ£Όμ–΄μ§€λ©΄ μ„Έ λ²μ§Έ μ  `P3 = P1 + P2`κ°€ νƒ€μ› κ³΅μ„  μ„μ— μλ„λ΅ κ³΅μ„  λ§μ…μ„ μ •μν•λ‹¤.

κΈ°ν•ν•™μ μΌλ΅ μ΄ μ„Έ λ²μ§Έ μ  P3μ€ P1κ³Ό P2 μ‚¬μ΄μ μ„ μ„ κ·Έλ ¤ κ³„μ‚°ν•λ‹¤. μ΄ μ„ μ€ μ •ν™•ν•κ² ν•λ‚μ μ¶”κ°€ μ¥μ†(λ†€λκ²λ„)μ—μ„ νƒ€μ› κ³΅μ„ κ³Ό κµμ°¨ν•λ‹¤. μ΄ μ μ„ `P3' = (x, y)`λΌκ³  λ¶€λ¥΄μ. μ΄μ–΄μ„ xμ¶•μ— λ°μ‚¬ν•μ—¬ `P3 = (x, -y)`λ¥Ό κµ¬ν•λ‹¤.

P1κ³Ό P2κ°€ κ°™μ€ μ μ΄λΌλ©΄ P1κ³Ό P2 μ‚¬μ΄μ μ„ μ€ μ΄ μ  P1μ—μ„ κ³΅μ„ μ— λ€ν• μ ‘μ„ μΌλ΅ ν™•μ¥λμ–΄μ•Ό ν•λ‹¤. μ΄ μ ‘μ„ μ€ μ •ν™•ν ν•λ‚μ μƒλ΅μ΄ μ μ—μ„ κ³΅μ„ κ³Ό κµμ°¨ν•λ‹¤. λ―Έμ λ¶„ κΈ°λ²•μ„ μ‚¬μ©ν•μ—¬ μ ‘μ„ μ κΈ°μΈκΈ°λ¥Ό κ²°μ •ν•  μ μλ‹¤. ν¥λ―Έλ΅­κ²λ„ μ΄ κΈ°μ μ€ 2μ°¨μ› μ •μ μΆν‘μƒμ— μλ” κ³΅μ„  μ„μ μ λ“¤μ—λ„ μ μ©ν•  μ μλ‹¤.

νƒ€μ› κ³΅μ„  μν•™μ—μ„λ” `λ¬΄ν•λ€ μ `μ΄λΌλ” μ λ„ μλ‹¤. μ΄ μ μ€ λ€λµ μ«μ 0μ μ—­ν• μ— ν•΄λ‹Ήν•λ‹¤. μ»΄ν“¨ν„°μ—μ„ `x = y = 0`μΌλ΅ ν‘μ‹λλ” μλ„ μλ‹¤(νƒ€μ› κ³΅μ„  λ°©μ •μ‹μ„ λ§μ΅±ν•μ§€λ” μ•μ§€λ§ μ‰½κ² ν™•μΈν•  μ μλ‹¤). λ¬΄ν•λ€ μ μ ν•„μ”μ„±μ„ μ„¤λ…ν•λ” λ‡ κ°€μ§€ νΉλ³„ν• μκ°€ μλ‹¤.

μ–΄λ–¤ κ²½μ°μ—λ” (μλ¥Ό λ“¤μ–΄, P1κ³Ό P2μ xκ°’μ΄ λ™μΌν•κ³  yκ°’μ€ λ‹¤λ¥΄λ‹¤λ©΄) μ„ μ΄ μ •ν™•ν μμ§μΌ κ²ƒμ΄κ³ , μ΄λ• P`3 = λ¬΄ν•λ€ μ `μ΄ λλ‹¤.

P1μ΄ λ¬΄ν•λ€ μ μ΄λΌλ©΄ `P1 + P2 = P2`μ΄λ‹¤. μ΄μ™€ λΉ„μ·ν•κ², P2κ°€ λ¬΄ν•λ€ μ μ΄λ©΄ `P1 + P2 = P1`μ΄λ‹¤.

λ¬΄ν•λ€ μ μ΄ 'μ •μƒμ μΈ' μ‚°μ μ—μ„ 0μ΄ λλ” κ²ƒμ„ λ³Ό μ μλ‹¤.

`+`λ” κ²°ν•©μ„±μ΄ μλ” κ²ƒμΌλ΅ λ°ν€μ΅λ”λ°, μ΄κ²ƒμ€ `(A + B) + C = A + (B + C)`λ¥Ό μλ―Έν•λ‹¤. μ¦‰, λ¨νΈν•¨ μ—†μ΄ `A + B + C`(κ΄„νΈ μ—†μ΄)λ¥Ό μ“Έ μ μλ‹¤.

μ•μ—μ„ λ§μ…μ„ μ •μν–μΌλ―€λ΅ λ§μ…μ„ ν™•μ¥ν•λ” ν‘μ¤€ λ°©μ‹μΌλ΅ κ³±μ…μ„ μ •μν•  μ μλ‹¤. νƒ€μ› κ³΅μ„  μƒμ μ  `P`μ— λ€ν•΄ `k`κ°€ μ •μμ΄λ©΄ `k * P = P + P + P + ... + P`(kλ² λ°λ³µ)μ΄λ‹¤. μ΄ κ²½μ°μ— kλ” λ•λ•λ΅(μ•„λ§λ„ νΌλ€μ¤λ½κ²) `μ§€μ(exponent)`λΌκ³ λ„ ν•λ‹¤.

### **4-3. κ³µκ°ν‚¤ μƒμ„±**

λ¬΄μ‘μ„λ΅ μƒμ„±ν• μ«μ `k`ν•νƒμ κ°μΈν‚¤λ΅ μ‹μ‘ν•μ—¬ `μƒμ„±μ μ (generator point) G`λΌκ³  ν•λ” κ³΅μ„ μ λ―Έλ¦¬ κ²°μ •λ μ μ— κ°μΈν‚¤λ¥Ό κ³±ν•μ—¬ κ³΅μ„  μƒμ λ‹¤λ¥Έ μ , μ¦‰ λ€μ‘ν•λ” κ³µκ°ν‚¤ `K`λ¥Ό μƒμ„±ν•λ‹¤.

```
K = k * G
```

μƒμ„±μ μ μ€ `secp256k1` ν‘μ¤€μ μΌλ¶€λ΅ μ§€μ •λμ–΄ μλ‹¤. `secp256k1`μ λ¨λ“  κµ¬ν„μ—μ„ λ™μΌν•λ©°, ν•΄λ‹Ή κ³΅μ„ μ—μ„ νμƒλ λ¨λ“  ν‚¤λ” λ™μΌν• μ  `G`λ¥Ό μ‚¬μ©ν•λ‹¤. μƒμ„±μ μ μ€ λ¨λ“  μ΄λ”λ¦¬μ›€ μ‚¬μ©μμ— λ€ν•΄ ν•­μƒ λ™μΌν•κΈ° λ•λ¬Έμ—, `G`μ™€ κ°μΈν‚¤ `k`λ¥Ό κ³±ν• κ²°κ³Όλ” ν•­μƒ κ³µκ°ν‚¤ `K`λ΅ λ™μΌν•λ‹¤. `k`μ™€ `K` μ‚¬μ΄μ κ΄€κ³„λ” κ³ μ •λμ–΄ μμ§€λ§, `k`μ—μ„ `K`κΉμ§€ ν• λ°©ν–¥μΌλ΅λ§ κ³„μ‚°ν•  μ μλ‹¤. μ΄λ° μ΄μ λ΅ μ΄λ”λ¦¬μ›€ μ£Όμ†(Kμ—μ„ νμƒλ¨)λ¥Ό λ¨λ“  μ‚¬λκ³Ό κ³µμ ν•  μ μμΌλ©° μ‚¬μ©μμ κ°μΈν‚¤(k)λ” κ³µκ°ν•μ§€ μ•λ”λ‹¤.

μ•μ—μ„ μ„¤λ…ν–λ“―μ΄, `k * G`μ κ³±μ…μ€ λ°λ³µλλ” λ§μ…, μ¦‰ `G + G + G + ... + G`(kλ² λ°λ³µ)μ™€ λ™μΌν•λ‹¤. μ”μ•½ν•λ©΄, κ°μΈν‚¤ `k`λ΅λ¶€ν„° κ³µκ°ν‚¤ `K`λ¥Ό μƒμ„±ν•κΈ° μ„ν•΄ μƒμ„±μ μ  `G`λ¥Ό κ·Έ μμ²΄μ— `kλ²` μ¶”κ°€ν•λ‹¤.

> κ°μΈν‚¤λ” κ³µκ°ν‚¤λ΅ λ³€ν™ν•  μ μμ§€λ§ κ³µκ°ν‚¤λ” κ°μΈν‚¤λ΅ λ‹¤μ‹ λ³€ν™ν•  μ μ—†λ‹¤. μ΄λ” μν•™μ΄ ν• λ°©ν–¥μΌλ΅λ§ μ‘λ™ν•κΈ° λ•λ¬Έμ΄λ‹¤.

### **4-4. νΉμ • κ°μΈν‚¤μ κ³µκ°ν‚¤λ¥Ό μ°Ύμ•„λ‚΄λ” μμ **

```
K = f8f8a2f43c8376ccb0871305060d7b27b0554d2cc72bccf41b2705608452f315 * G
```

μ•”νΈν™” λΌμ΄λΈλ¬λ¦¬λ” νƒ€μ› κ³΅μ„  κ³±μ…μ„ μ‚¬μ©ν•μ—¬ Kλ¥Ό κ³„μ‚°ν•λ” λ° λ„μ›€μ΄ λλ‹¤. κ²°κ³Ό κ³µκ°ν‚¤ Kλ” λ‹¤μκ³Ό κ°™μ€ μ μΌλ΅ μ •μν•λ‹¤.

```
K = (x, y)
```

μ—¬κΈ°μ„

```
x = 6e145ccef1033dea239875dd00dfb4fee6e3348b84985c92f103444683bae07b
y = 83b5c38e5e2b0c8529d7fa3f64d46daa1ece2d9ac14cab9477d042c84c32ccd0
```

μ΄λ”λ¦¬μ›€μ—μ„λ” 16μ§„μ λ¬Έμ(65λ°”μ΄νΈ) 130κ°μ μ‹λ¦¬μ–ΌλΌμ΄μ μ΄μ…(serialization)μΌλ΅ ν‘μ‹λλ” κ³µκ°ν‚¤λ¥Ό λ³Ό μ μλ‹¤. μ΄κ²ƒμ€ μ—…κ³„ ν‘μ¤€μΈ λ¥λ¥  μ•”νΈν™” ν‘μ¤€([Standards for Efficient Cryptography 1, SEC 1](https://www.secg.org/sec1-v2.pdf))μ—μ„ λ¬Έμ„ν™”λ μ‚°μ—… μ»¨μ†μ‹μ—„ λ¥λ¥  μ•”νΈ κ·Έλ£Ή ν‘μ¤€(Standards for Efficient Cryptography Group, SEGC)μ΄ μ μ•ν• ν‘μ¤€ μ‹λ¦¬μ–ΌλΌμ΄μ μ΄μ… ν•μ‹μ—μ„ μ±„νƒν–λ‹¤. μ΄ ν‘μ¤€μ€ μ•„λ ν‘μ— λ‚μ—΄λ νƒ€μ› κ³΅μ„ μ μ μ„ μ‹λ³„ν•λ” λ° μ‚¬μ©ν•  μ μλ” λ„¤ κ°€μ§€ κ°€λ¥ν• μ ‘λ‘μ–΄λ¥Ό μ •μν•λ‹¤.

**μ‹λ¦¬μ–ΌλΌμ΄μ¦λ EC κ³µκ°ν‚¤ μ ‘λ‘μ–΄**

|μ ‘λ‘μ–΄|μλ―Έ|κΈΈμ΄(μ ‘λ‘μ–΄ λ°”μ΄νΈ μ)|
|:--:|:--:|:--:|
|0x00|λ¬΄ν•λ€λ¥Ό κ°€λ¦¬ν‚΄|1|
|0x04|μ••μ¶•λμ§€ μ•μ€ μ§€μ |65|
|0x02|μ§μ yμ μ•”μ¶•λ μ |33|
|0x03|ν™€μ yμ μ••μ¶•λ μ |33|

μ΄λ”λ¦¬μ›€μ€ μ••μ¶•λμ§€ μ•μ€ κ³µκ°ν‚¤λ§μ„ μ‚¬μ©ν•λ‹¤. λ”°λΌμ„ κ΄€λ ¨λ μ μΌν• μ ‘λ‘μ–΄λ” (16μ§„μ)04μ΄λ‹¤. μ‹λ¦¬μ–ΌλΌμ΄μ μ΄μ…μ€ κ³µκ°ν‚¤μ xμ™€ yμΆν‘λ¥Ό μ—°κ²°ν•λ‹¤.

```
04 + xμΆν‘(32λ°”μ΄νΈ/64(16μ§„μ)) + yμΆν‘(32λ°”μ΄νΈ/64(16μ§„μ))
```

λ”°λΌμ„ μ΄μ „μ— κ³„μ‚°ν• κ³µκ°ν‚¤λ” λ‹¤μκ³Ό κ°™μ΄ μ‹λ¦¬μ–ΌλΌμ΄μ¦λλ‹¤.

```
046e145ccef1033dea239875dd00dfb4fee6e3348b84985c92f103444683bae07b83b5c38e5e2b0 \
c8529d7fa3f64d46daa1ece2d9ac14cab9477d042c84c32ccd0
```

### **4-5. νƒ€μ› κ³΅μ„  λΌμ΄λΈλ¬λ¦¬**

μ•”νΈν™”νμ™€ κ΄€λ ¨λ ν”„λ΅μ νΈμ— μ‚¬μ©λλ” `secp256k1` νƒ€μ› κ³΅μ„ μ„ κµ¬ν„ν• κ²ƒμ΄ λ‡ κ°€μ§€ μλ‹¤.

[OpenSSL](https://www.openssl.org)

* `OpenSSL λΌμ΄λΈλ¬λ¦¬`λ” `secp256k1`μ μ „μ²΄ κµ¬ν„μ„ ν¬ν•¨ν•μ—¬ ν¬κ΄„μ μΈ μ•”νΈν•™μ  κΈ°λ° μ”μ†(primitive)λ¥Ό μ κ³µν•λ‹¤. μλ¥Ό λ“¤μ–΄, κ³µκ°ν‚¤λ¥Ό μƒμ„±ν•λ ¤λ©΄ `EC_POINT_mul` ν•¨μλ¥Ό μ‚¬μ©ν•  μ μλ‹¤.

[libsecp256k1](https://github.com/bitcoin-core/secp256k1)

* λΉ„νΈμ½”μΈ μ½”μ–΄(Bitcoin Core)μ `libsecp256k1`μ€ νƒ€μ› κ³΅μ„  λ° κΈ°νƒ€ μ•”νΈν™” κΈ°μ΄ μ”μ†λ¥Ό C μ–Έμ–΄λ΅ κµ¬ν„ν• κ²ƒμ΄λ‹¤. λΉ„νΈμ½”μΈ μ½”μ–΄ μ†ν”„νΈμ›¨μ–΄μ—μ„ `OpenSSL`μ„ λ€μ²΄ν•κΈ° μ„ν•΄ μ™„μ „ν μƒλ΅ μ‘μ„±ν–μΌλ©°, μ„±λ¥κ³Ό λ³΄μ• λ©΄μ—μ„ λ¨λ‘ λ›°μ–΄λ‚ κ²ƒμΌλ΅ μ—¬κ²¨μ§„λ‹¤.

## **5. μ•”νΈν™” ν•΄μ‹ ν•¨μ**

μ•”νΈν™” ν•΄μ‹ ν•¨μ(hash function)λ” μ΄λ”λ¦¬μ›€ μ „λ°μ— κ±Έμ³ μ‚¬μ©λλ‹¤. μ‚¬μ‹¤, ν•΄μ‹ ν•¨μλ” κ±°μ λ¨λ“  μ•”νΈν•™μ  μ‹μ¤ν…μ—μ„ κ΄‘λ²”μ„ν•κ² μ‚¬μ©λκ³  μλ‹¤. μ΄κ²ƒμ€ μ•”νΈν•™μ [λΈλ£¨μ¤ μλ‚μ΄μ–΄(Bruce Schneier)](https://www.schneier.com/essays/archives/2004/08/cryptanalysis_of_md5.html)λ„ λ™μν• μ‚¬μ‹¤μΈλ°, κ·Έλ” μ΄λ ‡κ² λ§ν–λ‹¤. "μ•”νΈν™” μ•κ³ λ¦¬μ¦λ³΄λ‹¤ λ‹¨λ°©ν–¥ ν•΄μ‹ ν•¨μλ“¤μ΄ ν„λ€ μ•”νΈν•™μ„ λ” μ μ΄λ„λ” κ²¬μΈμ°¨λ‹¤."

μ΄ μ μ—μ„λ” ν•΄μ‹ ν•¨μμ— λ€ν•΄ λ…Όμν•κ³ , κΈ°λ³Έ μ†μ„±μ„ νƒμƒ‰ν•λ©°, μ΄λ¬ν• μ†μ„±μ„ μ–΄λ–»κ² ν„λ€ μ•”νΈν•™ λ¶„μ•Όμ—μ„ λ§¤μ° μ μ©ν•κ² μ‚¬μ©ν•λ”μ§€ μ‚΄ν΄λ³Έλ‹¤. μ΄λ”λ¦¬μ›€ κ³µκ°ν‚¤ μ£Όμ†λ΅ λ³€ν™ν•λ” μ‘μ—…μ—μ„ ν•΄μ‹ ν•¨μκ°€ μΌλ¶€λ¶„μ„ μ°¨μ§€ν•κΈ° λ•λ¬Έμ— μ—¬κΈ°μ—μ„ ν•΄μ‹ ν•¨μλ¥Ό λ‹¤λ£¬λ‹¤. λν• λ°μ΄ν„° ν™•μΈμ— λ„μ›€μ΄ λλ” `λ””μ§€ν„Έ μ§€λ¬Έ(digital fingerprints)`μ„ λ§λ“λ” λ° μ‚¬μ©ν•  μ μλ‹¤.

κ°„λ‹¨ν λ§ν•λ©΄, [ν•΄μ‹ ν•¨μ(hash function)](https://en.wikipedia.org/wiki/Hash_function)λ” 'μ„μ ν¬κΈ°μ λ°μ΄ν„°λ¥Ό κ³ μ •λ ν¬κΈ°μ λ°μ΄ν„°λ΅ λ§¤ν•‘ν•λ” λ° μ‚¬μ©ν•  μ μλ” λ¨λ“  ν•¨μ'λ‹¤. ν•΄μ‹ ν•¨μμ— λ€ν• μ…λ ¥μ„ `μ‚¬μ „ μ΄λ―Έμ§€(pre-image)`, `λ©”μ‹μ§€(message)` λλ” `μ…λ ¥ λ°μ΄ν„°(input data)`λΌκ³  ν•λ‹¤. κ·Έλ¦¬κ³  κ·Έ κ²°κ³Όλ¥Ό `ν•΄μ‹(hash)`λΌκ³  ν•λ‹¤. [μ•”νΈν™” ν•΄μ‹ ν•¨μ(cryptographic hash function)](https://en.wikipedia.org/wiki/Cryptographic_hash_function)λ” μ΄λ”λ¦¬μ›€ κ°™μ€ ν”λ«νΌμ„ λ³΄νΈν•λ” λ° μ μ©ν• νΉμ • μ†μ„±μ„ κ°–λ” νΉλ³„ν• ν•μ„ λ²”μ£Όλ‹¤.

μ•”νΈ ν•΄μ‹ ν•¨μλ” μ„μ ν¬κΈ°μ λ°μ΄ν„°λ¥Ό κ³ μ • ν¬κΈ°μ λΉ„νΈ μ—΄λ΅ λ§¤ν•‘ν•λ” `λ‹¨λ°©ν–¥(one-way)` ν•΄μ‹ ν•¨μλ‹¤. 'λ‹¨λ°©ν–¥' νΉμ„±μ€ κ²°κ΄κ°’ ν•΄μ‹λ§ μ•κ³  μμ„ λ• μ…λ ¥ λ°μ΄ν„°λ¥Ό λ‹¤μ‹ μ‘μ„±ν•λ” κ²ƒμ΄ κ³„μ‚°μ μΌλ΅ λ¶κ°€λ¥ν•¨μ„ μλ―Έν•λ‹¤. κ°€λ¥ν• μ…λ ¥μ„ κ²°μ •ν•λ” μ μΌν• λ°©λ²•μ€ κ° ν›„λ³΄μ— μΌμΉν•λ” κ²°κ³Όκ°€ μλ”μ§€ ν™•μΈν•λ©΄μ„ λ¬΄μ°¨λ³„ λ€μ… κ²€μƒ‰μ„ μν–‰ν•λ” κ²ƒμ΄λ‹¤. κ²€μƒ‰ κ³µκ°„μ΄ μ‚¬μ‹¤μƒ λ¬΄ν•ν•λ‹¤λ” μ μ„ κ³ λ ¤ν•  λ• μ‘μ—…μ΄ μ‹¤μ λ΅ λ¶κ°€λ¥ν•λ‹¤λ” κ²ƒμ„ μ‰½κ² μ΄ν•΄ν•  μ μλ‹¤. μΌμΉν•λ” ν•΄μ‹λ¥Ό λ§λ“λ” μΌλ¶€ μ…λ ¥ λ°μ΄ν„°λ¥Ό μ°Ύλ”λ‹¤κ³  ν•λ”λΌλ„ μ›λ³Έ μ…λ ¥ λ°μ΄ν„°κ°€ μ•„λ‹ μ μλ‹¤. ν•΄μ‹ ν•¨μλ” 'λ‹¤λ€μΌ' ν•¨μλ‹¤. λ™μΌν• κ²°κ³Όμ— ν•΄μ‹ μ²λ¦¬ν• λ‘ μ…λ ¥ λ°μ΄ν„° μ§‘ν•©μ„ μ°Ύλ” κ²ƒμ„ `ν•΄μ‹ μ¶©λ(hash collision)` μ°ΎκΈ°λΌκ³  ν•λ‹¤. κ°„λ‹¨ν λ§ν•΄μ„, ν•΄μ‹ ν•¨μκ°€ μΆ‹μ„μλ΅ ν•΄μ‹ μ¶©λμ΄ λ λ°μƒν•λ‹¤. μ΄λ”λ¦¬μ›€μ—μ„λ” μ‚¬μ‹¤μƒ ν•΄μ‹ μ¶©λμ΄ λ¶κ°€λ¥ν•λ‹¤.

μ•”νΈν™” ν•΄μ‹ ν•¨μμ μ£Όμ† μ†μ„±μ„ μμ„Έν μ‚΄ν΄λ³΄μ.

**κ²°μ •λ΅ (determinism)**

* μ£Όμ–΄μ§„ μ…λ ¥ λ©”μ‹μ§€λ” ν•­μƒ λ™μΌν• ν•΄μ‹ κ²°κ³Όλ¥Ό μƒμ„±ν•λ‹¤.

**κ²€μ¦μ„±(verifiability)**

* λ©”μ‹μ§€μ ν•΄μ‹ κ³„μ‚°μ€ ν¨μ¨μ μ΄λ‹¤(μ„ ν• λ³µμ΅μ„±).

**λΉ„μƒκ΄€μ„±(noncorrelation)**

* λ©”μ‹μ§€μ— λ€ν• μ‘μ€ λ³€ν™”(μ: 1λΉ„νΈ λ³€κ²½)λ” ν•΄μ‹ μ¶λ ¥μ„ λ„λ¬΄ κ΄‘λ²”μ„ν•κ² λ³€κ²½ν•΄μ•Ό ν•΄μ„ μ›λ³Έ λ©”μ‹μ§€μ ν•΄μ‹κ³Ό μƒκ΄€ κ΄€κ³„κ°€ μ—†λ‹¤.

**λΉ„κ°€μ—­μ„±(irreversibility)**

* ν•΄μ‹λ΅λ¶€ν„° λ©”μ‹μ§€λ¥Ό κ³„μ‚°ν•λ” κ²ƒμ€ λ¶κ°€λ¥ν•λ‹¤. λ¨λ“  κ°€λ¥ν• λ©”μ‹μ§€μ— λ€ν• λ¬΄μ°¨λ³„ κ²€μƒ‰(brute-force search)κ³Ό κ°™λ‹¤.

**μ¶©λ λ°©μ§€(collision protection)**

* κ°™μ€ ν•΄μ‹ κ²°κ³Όλ¥Ό μƒμ„±ν•λ” 2κ°μ μ„λ΅ λ‹¤λ¥Έ λ©”μ‹μ§€λ¥Ό κ³„μ‚°ν•λ” κ²ƒμ€ λ¶κ°€λ¥ν•λ‹¤.

ν•΄μ‹ μ¶©λμ— λ€ν• μ €ν•­μ€ νΉν μ΄λ”λ¦¬μ›€μ—μ„ λ””μ§€ν„Έ μ„λ… μ„μ΅°λ¥Ό ν”Όν•κΈ° μ„ν•΄ μ¤‘μ”ν•λ‹¤.

μ΄λ¬ν• μ†μ„±μ„ μ΅°ν•©ν•λ©΄ μ•”νΈν™” ν•΄μ‹ κΈ°λ¥μ΄ λ‹¤μκ³Ό κ°™μ€ λ‹¤μ–‘ν• λ³΄μ• μ• ν”λ¦¬μΌ€μ΄μ…μ— μ μ©ν•λ‹¤.

* λ°μ΄ν„° ν•‘κ±°ν”„λ¦°ν…
* λ©”μ‹μ§€ λ¬΄κ²°μ„±(μ¤λ¥ κ°μ§€)
* μ‘μ—…μ¦λ…
* μΈμ¦(μ•”νΈ ν•΄μ‹± λ° μ¤νΈλμΉ­)
* μμ‚¬ λ‚μ μƒμ„±κΈ°
* λ©”μ‹μ§€ μ»¤λ°‹(μ»¤λ°‹-κ³µκ° λ©”μ»¤λ‹μ¦)
* κ³ μ  μ‹λ³„μ

### **5-1. μ΄λ”λ¦¬μ›€ μ•”νΈν™” ν•΄μ‹ ν•¨μ : Keccak-256**

μ΄λ”λ¦¬μ›€μ€ λ§μ€ κ³³μ—μ„ `Keccak-256` μ•”νΈν™” ν•΄μ‹ ν•¨μλ¥Ό μ‚¬μ©ν•λ‹¤. `Keccak-256`μ€ 2007λ…„ κµ­λ¦½ κ³Όν•™ κΈ°μ  μ—°κµ¬μ†(National Institute of Science and Technology)μ—μ„ κ°μµν• `SHA-3` μ•”νΈν™” ν•΄μ‹ ν•¨μ κ²½μ λ€ν(SHA-3 Cryptographic Hash Function Competition)μ ν›„λ³΄λ΅ μ„¤κ³„λμ—λ‹¤. `Keccak`μ€ μ°μΉν• μ•κ³ λ¦¬μ¦μΌλ΅, 2015λ…„ FIPS(Federal Information Processing Standard) 202λ΅ ν‘μ¤€ν™”λμ—λ‹¤.

κ·Έλ¬λ‚ μ΄λ”λ¦¬μ›€μ„ κ°λ°ν•λ” κΈ°κ°„ λ™μ• λ―Έκµ­ ν‘μ¤€κΈ°μ μ—°κµ¬μ†(NIST)μ ν‘μ¤€ν™”λ” μ•„μ§ μ™„λ£λμ§€ μ•μ•λ‹¤. NISTμ μ£Όμ¥μ— λ”°λ¥΄λ©΄, ν‘μ¤€ ν”„λ΅μ„Έμ¤λ¥Ό μ™„λ£ν• ν›„ `Keccak`μ μΌλ¶€ νλΌλ―Έν„°λ¥Ό μ΅°μ •ν•μ—¬ ν¨μ¨μ„±μ„ ν–¥μƒν–λ‹¤κ³  ν•λ‹¤. ν•μ§€λ§ μ΄κ²ƒμ€ λ―Έκµ­ κµ­κ°€μ•λ³΄κµ­(National Security Agency)μ λ¶€μ μ ν• μν–¥μ„ λ°›μ•„ Dual_EC_DRBG λ‚μ μƒμ„±κΈ° ν‘μ¤€μ„ μλ„μ μΌλ΅ μ•½ν™”μ‹μΌ ν‘μ¤€ λ‚μ μƒμ„±κΈ°μ— λ°±λ„μ–΄λ¥Ό ν¨κ³Όμ μΌλ΅ λ°°μΉν–λ‹¤λ” λ¬Έμ„λ¥Ό λ‚΄λ¶€ κ³ λ°μμΈ μ—λ“μ›λ“ μ¤λ…Έλ“ (Edward Snowden)μ΄ κ³µκ°ν–λ‹¤. μ΄ λ…Όμμ κ²°κ³Όλ” μ μ•ν• λ³€κ²½μ— λ€ν• λ°λ°λ΅ μΈν•΄ `SHA-3`μ ν‘μ¤€ν™”μ— μƒλ‹Ήν• μ§€μ—°μ„ μ΄λν–λ‹¤. λ‹Ήμ‹ μ΄λ”λ¦¬μ›€ μ¬λ‹¨μ€ NISTμ—μ„ μμ •ν• `SHA-3` ν‘μ¤€μ΄ μ•„λ‹, μ΄ μ•κ³ λ¦¬μ¦μ λ°λ…κ°€λ“¤μ΄ μ μ•ν• λ€λ΅ μ›λ `Keccak` μ•κ³ λ¦¬μ¦μ„ κµ¬ν„ν•κΈ°λ΅ κ²°μ •ν–λ‹¤.

> μ΄λ”λ¦¬μ›€ λ¬Έμ„μ™€ μ½”λ“μ—μ„ μ–ΈκΈ‰λ 'SHA-3'μ„ λ³Ό μλ„ μμ§€λ§, μ‹¤μ λ΅ λ¨λ“  μλ” μ•„λ‹λ”λΌλ„ λ§μ€ κ²ƒμ΄ FIPS-202 SHA-3 ν‘μ¤€μ΄ μ•„λ‹ Keccak-256μ„ μ°Έκ³ ν•λ‹¤. κµ¬ν„ μ°¨μ΄λ” ν¨λ”© νλΌλ―Έν„°μ™€ κ΄€λ ¨ν•μ—¬ λ―Έλ―Έν•μ§€λ§, Keccak-256μ΄ λ™μΌν• μ…λ ¥μ— λ€ν•΄ FIPS-202 SHA-3κ³Όλ” λ‹¤λ¥Έ ν•΄μ‹ κ²°κ³Όλ¥Ό μƒμ„±ν•λ‹¤λ” μ μ—μ„ μ¤‘μ”ν•λ‹¤.

### **5-2. μ–΄λ–¤ ν•΄μ‹ ν•¨μλ¥Ό μ‚¬μ©ν•κ³  μλ”κ°€?**

λ‘ μ†ν”„νΈμ›¨μ–΄ λ¨λ‘ `SHA-3`μ΄λΌλ©΄, μ‚¬μ© μ¤‘μΈ μ†ν”„νΈμ›¨μ–΄ λΌμ΄λΈλ¬λ¦¬κ°€ `FIPS-202 SHA-3` λλ” `Keccak-256`μ„ κµ¬ν„ν•λ”μ§€ μ–΄λ–»κ² μ• μ μλ”κ°€?

μ‰½κ² μ• μ μλ” λ°©λ²•μ€ μ£Όμ–΄μ§„ μ…λ ¥μ— λ€ν•΄ μμƒλλ” κ²°κ³ΌμΈ `ν…μ¤νΈ λ²΅ν„°(test vector)`λ¥Ό μ‚¬μ©ν•λ” κ²ƒμ΄λ‹¤. ν•΄μ‹ ν•¨μκ°€ κ°€μ¥ μΌλ°μ μΌλ΅ μ‚¬μ©λλ” ν…μ¤νΈλ” `λΉ μ…λ ¥(empty input)`μ΄λ‹¤. λΉ λ¬Έμμ—΄μ„ μ…λ ¥μΌλ΅ ν•΄μ‹ ν•¨μλ¥Ό μ‹¤ν–‰ν•λ©΄ λ‹¤μκ³Ό κ°™μ€ κ²°κ³Όκ°€ λ‚μ¨λ‹¤.

```
Keccak256("") =
  c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470

SHA3("") =
  a7ffc6f8bf1ed76651c14756a061d662f580ff4de43b49fa82d80a4b80f8434a
```

ν•¨μκ°€ λ¬΄μ—‡μΈμ§€μ— κ΄€κ³„μ—†μ΄ μ΄ κ°„λ‹¨ν• ν…μ¤νΈλ¥Ό μ‹¤ν–‰ν•μ—¬ μ›λ `Keccak-256`μΈμ§€ λλ” μµμΆ… NIST ν‘μ¤€ `FIPS-202 SHA-3`μΈμ§€ μ—¬λ¶€λ¥Ό ν…μ¤νΈν•  μ μλ‹¤. μ΄λ”λ¦¬μ›€μ€ μ½”λ“μ—μ„ μΆ…μΆ… `SHA-3`μ΄λΌκ³  λ¶λ¦¬κΈ°λ” ν•μ§€λ§ `Keccak-256`μ„ μ‚¬μ©ν•λ‹¤.

> μ΄λ”λ¦¬μ›€(Keccak-256)κ³Ό μµμΆ… ν‘μ¤€(FIP-202 SHA-3)μ—μ„ μ‚¬μ©ν• ν•΄μ‹ ν•¨μμ μ°¨μ΄λ΅ μΈν•΄ νΌλ€μ΄ μκΈ° λ•λ¬Έμ— λ¨λ“  μ½”λ“, μ—°μ‚°μ½”λ“(opcode) λ° λΌμ΄λΈλ¬λ¦¬ sha3 μΈμ¤ν„΄μ¤λ¥Ό λ¨λ‘ keccak256μΌλ΅ κ°λ…ν•κΈ° μ„ν• λ…Έλ ¥μ΄ μ§„ν–‰μ¤‘μ΄λ‹¤. [ERC59](https://bit.ly/2HmGcpG)

λ‹¤μμΌλ΅ μ΄λ”λ¦¬μ›€μ—μ„ `Keccak-256`μ μ²« λ²μ§Έ μ• ν”λ¦¬μΌ€μ΄μ…μ„ μ‚΄ν΄λ³΄μ. μ΄ μ• ν”λ¦¬μΌ€μ΄μ…μ€ κ³µκ°ν‚¤λ΅ μ΄λ”λ¦¬μ›€ μ£Όμ†λ¥Ό μƒμ„±ν•λ” κ²ƒμ΄λ‹¤.

## **6. μ΄λ”λ¦¬μ›€ μ£Όμ†**

μ΄λ”λ¦¬μ›€ μ£Όμ†λ” `Keccak-256` λ‹¨λ°©ν–¥ ν•΄μ‹ ν•¨μλ¥Ό μ‚¬μ©ν•λ” κ³µκ°ν‚¤ λλ” μ»¨νΈλ™νΈμ—μ„ νμƒν• `κ³ μ  μ‹λ³„μ(unique identifier)`λ‹¤.

μ΄μ „ μμ μ—μ„λ” κ°μΈν‚¤λ΅ μ‹μ‘ν•΄μ„ νƒ€μ› κ³΅μ„  κ³±μ…μ„ μ‚¬μ©ν•μ—¬ κ³µκ°ν‚¤λ¥Ό λ§λ“¤μ—λ‹¤.

κ°μΈν‚¤ : `k`
```
k = f8f8a2f43c8376ccb0871305060d7b27b0554d2cc72bccf41b2705608452f315
```

κ³µκ°ν‚¤ `K` (x λ° y μΆν‘κ°€ μ—°κ²°λκ³  16μ§„μλ΅ ν‘μ‹λ¨)
```
K = 6e145ccef1033dea239875dd00dfb4fee6e3348b84985c92f103444683bae07b83b5c38e5e...
```

> μ£Όμ†λ¥Ό κ³„μ‚°ν•  λ• κ³µκ°ν‚¤κ°€ μ ‘λ‘μ–΄(16μ§„μ) 04λ΅ ν¬λ§·λμ§€ μ•μ•λ‹¤λ” μ‚¬μ‹¤μ€ μ£Όλ©ν•  λ§ν• κ°€μΉκ°€ μλ‹¤.


`Keccak-256`μ„ μ‚¬μ©ν•μ—¬ μ΄ κ³µκ°ν‚¤μ `ν•΄μ‹`λ¥Ό κ³„μ‚°ν•λ‹¤.
```
Keccak256(K) = 2a5bc342ed616b5ba5732269001d3f1ef827552ae1114027bd3ecf1f086ba0f9
```

κ·Έλ° λ‹¤μ, μ΄λ”λ¦¬μ›€ μ£Όμ†μΈ λ§μ§€λ§‰ 20λ°”μ΄νΈ(μµν•μ„ λ°”μ΄νΈ)λ§ μ μ§€ν•λ‹¤.
```
001d3f1ef827552ae1114027bd3ecf1f086ba0f9
```

μΆ…μΆ… μ΄λ”λ¦¬μ›€ μ£Όμ†κ°€ μ ‘λ‘μ–΄ 0xλ΅ ν‘μ‹λμ–΄ λ‹¤μκ³Ό κ°™μ΄ 16μ§„μλ΅ μΈμ½”λ”©λ κ²ƒμ„ λ³Ό κ²ƒμ΄λ‹¤.
```
0x001d3f1ef827552ae1114027bd3ecf1f086ba0f9
```

### **6-1. μ΄λ”λ¦¬μ›€ μ£Όμ† ν•μ‹**

μ΄λ”λ¦¬μ›€ μ£Όμ†λ” 16μ§„μμ΄λ©°, κ³µκ°ν‚¤ `Keccak-256` ν•΄μ‹μ λ§μ§€λ§‰ 20λ°”μ΄νΈμ—μ„ νμƒν• μ‹λ³„μλ‹¤.

λ¨λ“  ν΄λΌμ΄μ–ΈνΈμ μ‚¬μ©μ μΈν„°νμ΄μ¤μ— λ‚΄μ¥λ μ²΄ν¬μ„¬μ„ ν¬ν•¨ν•μ—¬ μλ» μ…λ ¥λ μ£Όμ†λ¥Ό λ³΄νΈν•λ„λ΅ μΈμ½”λ”©λ λΉ„νΈμ½”μΈ μ£Όμ†μ™€ λ‹¬λ¦¬ μ΄λ”λ¦¬μ›€ μ£Όμ†λ” μ²΄ν¬μ„¬μ΄ μ—†λ” μ›μ‹ 16μ§„μλ΅ ν‘μ‹ν•λ‹¤.

κ·Έ κ²°μ •μ κ·Όκ±°λ” μ΄λ”λ¦¬μ›€ μ£Όμ†κ°€ κ²°κµ­ μ‹μ¤ν…μ μƒμ„ κ³„μΈµμ—μ„ μ¶”μƒν™”(μ: μ΄λ¦„ μ„λΉ„μ¤)μ— μ¨κ²¨μ§€κ³  ν•„μ”ν•λ‹¤λ©΄ μƒμ„ κ³„μΈµμ— μ²΄ν¬μ„¬μ„ μ¶”κ°€ν•΄μ•Ό ν•λ‹¤λ” κ²ƒμ΄λ‹¤.

ν„μ‹¤μ μΌλ΅ μ΄λ¬ν• μƒμ„ κ³„μΈµμ€ λ„λ¬΄ λλ¦¬κ² κ°λ°λμ—μΌλ©°, μ΄λ¬ν• μ„¤κ³„ μ„ νƒμ€ μλ» μ…λ ¥ν• μ£Όμ† λ° μ…λ ¥ μ ν¨μ„± μ¤λ¥λ΅ μΈν• μκΈ μ†μ‹¤ λ“± μƒνƒκ³„ μ΄κΈ°μ— μ—¬λ¬ κ°€μ§€ λ¬Έμ λ¥Ό λ°μƒμ‹μΌ°λ‹¤. λν• μ΄λ”λ¦¬μ›€ μ΄λ¦„ μ„λΉ„μ¤κ°€ μ²μ μμƒλ³΄λ‹¤ λλ¦¬κ² κ°λ°λμ—κΈ° λ•λ¬Έμ— μ§€κ°‘ κ°λ°μλ” λ€μ²΄ μΈμ½”λ”©μ„ λ§¤μ° μ²μ²ν μ±„νƒν–λ‹¤. λ‹¤μμΌλ΅ μΈμ½”λ”© μµμ… λ‡ κ°€μ§€λ¥Ό μ‚΄ν΄λ³΄μ.

### **6-2. ν΄λΌμ΄μ–ΈνΈ μ£Όμ† μƒνΈκµν™ ν”„λ΅ν† μ½**

`ν΄λΌμ΄μ–ΈνΈ μ£Όμ† μƒνΈκµν™ ν”„λ΅ν† μ½(Inter exchange Client Address Protocol, ICAP)`μ€ κµ­μ  μ€ν–‰ κ³„μΆ λ²νΈ(International Bank Account Number, IBAN) μΈμ½”λ”©κ³Ό λ¶€λ¶„μ μΌλ΅ νΈν™λλ” μ΄λ”λ¦¬μ›€ μ£Όμ† μΈμ½”λ”©μΌλ΅, μ΄λ”λ¦¬μ›€ μ£Όμ†μ— λ€ν•΄ λ‹¤λ©μ μ μ²΄ν¬μ„¬μ΄ κ°€λ¥ν•κ³  μƒνΈμ΄μ© κ°€λ¥ν• μΈμ½”λ”©μ„ μ κ³µν•λ‹¤. ICAP μ£Όμ†λ” μ΄λ”λ¦¬μ›€ μ΄λ¦„ λ μ§€μ¤νΈλ¦¬μ— λ“±λ΅ν• μ΄λ”λ¦¬μ›€ μ£Όμ† λλ” μΌλ° μ΄λ¦„μ„ μΈμ½”λ”©ν•  μ μλ‹¤. [μ΄λ”λ¦¬μ›€ μ„ν‚¤](https://github.com/ethereum/wiki/wiki/Inter-exchange-Client-Address-Protocol-(ICAP))μ— ICAPμ— λ€ν•΄ λ” λ§μ€ μ •λ³΄κ°€ μλ‹¤.

IBANμ€ μ€ν–‰ κ³„μΆ λ²νΈλ¥Ό μ‹λ³„ν•κΈ° μ„ν• κµ­μ  ν‘μ¤€μΌλ΅ μ£Όλ΅ μ€ν–‰ μ†΅κΈμ— μ‚¬μ©ν•λ©°, μ λ½ λ‹¨μΌ μ λ΅ μ§€κΈ‰ μ§€μ—­(Single Euro Payments Area, SEPA) λ° κ·Έ μ΄μƒ μ§€μ—­μ—μ„ κ΄‘λ²”μ„ν•κ² μ±„νƒλλ‹¤. IBANμ€ μ¤‘μ•™ μ§‘μ¤‘μ μ΄κ³  μ—„κ²©ν•κ² κ·μ λλ” μ„λΉ„μ¤λ‹¤. ICAPλ” νƒμ¤‘μ•™ν™”ν•μ΄μ§€λ§ μ΄λ”λ¦¬μ›€ μ£Όμ†μ— λ€ν• νΈν™ κ°€λ¥ν•λ‹¤.

IBANμ€ κµ­κ°€ μ½”λ“, μ²΄ν¬μ„¬ λ° μ€ν–‰ κ³„μΆ μ‹λ³„μ(κµ­κ°€λ³„)λ¥Ό ν¬ν•¨ν•λ” μµλ€ 34κ°μ μμ«μ(λ€μ†λ¬Έμλ¥Ό κµ¬λ¶„ν•μ§€ μ•μ)λ΅ κµ¬μ„±λ λ¬Έμμ—΄λ΅ κµ¬μ„±ν•λ‹¤.

ICAPλ” μ΄λ”λ¦¬μ›€μ„ λ‚νƒ€λ‚΄λ” λΉ„ν‘μ¤€ κµ­κ°€ μ½”λ“ `XE`λ¥Ό λ„μ…ν• ν›„μ— λ‘ λ¬Έμ μ²΄ν¬μ„¬κ³Ό κ³„μ • μ‹λ³„μμ μ„Έ κ°€μ§€ κ°€λ¥ν• λ³€ν•μ„ λ„μ…ν•μ—¬ λ™μΌν• κµ¬μ΅°λ¥Ό μ‚¬μ©ν•λ‹¤.

**μ§μ ‘(Direct)**

μ΄λ”λ¦¬μ›€ μ£Όμ†μ μµν•μ„ λΉ„νΈ 155κ°λ¥Ό λ‚νƒ€λ‚΄λ” μµλ€ 30μμ μμ«μλ΅ κµ¬μ„±λ λΉ…μ—”λ””μ•(big-endian) base36 μ •μλ‹¤. μ΄ μΈμ½”λ”©μ€ μΌλ° μ΄λ”λ¦¬μ›€ μ£Όμ†μ μ „μ²΄ 160λΉ„νΈλ³΄λ‹¤ μ κΈ° λ•λ¬Έμ— ν•λ‚ μ΄μƒμ 0λ°”μ΄νΈλ΅ μ‹μ‘ν•λ” μ΄λ”λ¦¬μ›€ μ£Όμ†μ—μ„λ§ λ™μ‘ν•λ‹¤. μ¥μ μ€ ν•„λ“ κΈΈμ΄μ™€ μ²΄ν¬μ„¬ μΈ΅λ©΄μ—μ„ IBANκ³Ό νΈν™λλ‹¤λ” κ²ƒμ΄λ‹¤. 

μ: XE60HAMICDXSV5QXVJA7TJW47Q9CHWKJD (33μ κΈΈμ΄)

**κΈ°λ³Έ(Basic)**

μ§μ ‘ μΈμ½”λ”©κ³Ό λ™μΌν•μ§€λ§ κΈΈμ΄λ” 31μλ‹¤. μ΄λ ‡κ² ν•λ©΄ μ΄λ”λ¦¬μ›€ μ£Όμ†λ¥Ό μΈμ½”λ”©ν•  μ μμ§€λ§ IBAN ν•„λ“ μ ν¨μ„± κ²€μ‚¬μ™€ νΈν™λμ§€ μ•λ”λ‹¤.

μ: XE18CHDJBPLTBCJ03FE9O2NS0BPOJVQCU2P (35μ κΈΈμ΄)

**κ°„μ ‘(Indirect)**

μ΄λ¦„ λ μ§€μ¤νΈλ¦¬ κ³µκΈ‰μλ¥Ό ν†µν•΄ μ΄λ”λ¦¬μ›€ μ£Όμ†λ΅ ν™•μΈλλ” μ‹λ³„μλ¥Ό μΈμ½”λ”©ν•λ‹¤. `μμ‚° μ‹λ³„μ(asset identifier, μ: ETH)`, μ΄λ¦„ μ„λΉ„μ¤(μ: XREG) λ° μ‚¬λμ΄ μ½μ„ μ μλ” 9μμ μ΄λ¦„(μ: KITTYCATS)μΌλ΅ κµ¬μ„±λ 16κ°μ μμ«μλ¥Ό μ‚¬μ©ν•λ‹¤.

μ: XE##ETHXREGKITTYCATS (20μ κΈΈμ΄)

μ—¬κΈ°μ„ ##λ” 2κ°μ κ³„μ‚°λ μ²΄ν¬μ„¬ λ¬Έμλ΅ λ€μ²΄ν•΄μ•Ό ν•λ‹¤.

&nbsp;

helpeth μ»¤λ§¨λ“ λΌμΈ λ„κµ¬λ¥Ό μ‚¬μ©ν•μ—¬ ICAP μ£Όμ†λ¥Ό λ§λ“¤ μ μλ‹¤. μμ λ΅ κ°μΈν‚¤λ¥Ό λ§λ“¤μ–΄ λ³΄μ(0xλ΅ μ ‘λ‘μ–΄λ¥Ό λ¶™μ΄κ³ , νλΌλ―Έν„°λ¥Ό helpethλ΅ μ „λ‹¬ν•¨).

```
$ helpeth keyDetails \
  -p 0xf8f8a2f43c8376ccb0871305060d7b27b0554d2cc72bccf41b2705608452f315

Address: 0x001d3f1ef827552ae1114027bd3ecf1f086ba0f9
ICAP: XE60 HAMI CDXS V5QX VJA7 TJW4 7Q9C HWKJ D
Public key: 0x6e145ccef1033dea239875dd00dfb4fee6e3348b84985c92f103444683bae07b...
```

helpeth λ…λ Ήμ€ ICAP μ£Όμ†λΏλ§ μ•„λ‹λΌ 16μ§€μ μ΄λ”λ¦¬μ›€ μ£Όμ†λ¥Ό λ§λ“ λ‹¤. μμ  ν‚¤μ ICAP μ£Όμ†λ” λ‹¤μκ³Ό κ°™λ‹¤.

```
XE60HAMICDXSV5QXVJA7TJW47Q9CHWKJD
```

μμ  μ΄λ”λ¦¬μ›€ μ£Όμ†λ” 0λ°”μ΄νΈλ΅ μ‹μ‘ν•κΈ° λ•λ¬Έμ— IBAN ν•μ‹μΌλ΅ μ ν¨ν• μ§μ ‘(Direct) ICAP μΈμ½”λ”© λ°©λ²•μ„ μ‚¬μ©ν•μ—¬ μΈμ½”λ”©ν•  μ μλ‹¤. μ΄κ²ƒμ€ κΈΈμ΄κ°€ 33μλΌλ” μ μ—μ„ μ•μ•„μ°¨λ¦΄ μ μλ‹¤.

μ£Όμ†κ°€ 0μΌλ΅ μ‹μ‘ν•μ§€ μ•μΌλ©΄ κΈ°λ³Έ(Basic) μΈμ½”λ”©μΌλ΅ μΈμ½”λ”©ν•λ‹¤. κΈΈμ΄λ” 35μμ΄κ³  IBANμ€ μ ν¨ν•μ§€ μ•λ‹¤.

> 0λ°”μ΄νΈλ΅ μ‹μ‘ν•λ” μ΄λ”λ¦¬μ›€ μ£Όμ†μ ν™•λ¥ μ€ 256λ¶„μ 1μ΄λ‹¤. μ΄λ° κ²ƒμ„ μƒμ„±ν•λ ¤λ©΄ IBANκ³Ό νΈν™ κ°€λ¥ν• 'μ§μ ‘(Direct)' μΈμ½”λ”©λ ICAP μ£Όμ†λ΅ μ‘λ™ν•λ” κ²ƒμ„ μ°ΎκΈ° μ „μ— 256κ°μ λ‹¤λ¥Έ μ„μμ κ°μΈν‚¤λ΅ ν‰κ·  256λ²μ„ μ‹λ„ν•΄μ•Ό ν•λ‹¤.

ν„μ¬ ICAPλ” λ¶ν–‰νλ„ λ‡ κ°€μ§€ μ§€κ°‘μ—λ§ μ§€μ›ν•λ‹¤.

### **6-3. λ€λ¬Έμλ΅ 16μ§„μ μΈμ½”λ”©λ μ²΄ν¬μ„¬(EIP-55)**

ICAPμ™€ λ„¤μ„ μ„λΉ„μ¤μ λλ¦° λ°°ν¬ λ•λ¬Έμ— μ΄λ”λ¦¬μ›€ κ°μ„  μ μ•([Ethereum Improvement Proposal 55, EIP-55](https://github.com/Ethereum/EIPs/blob/master/EIPS/eip-55.md))μ—μ„ ν‘μ¤€μ„ μ μ•ν–λ‹¤. EIP-55λ” 16μ§„μ μ£Όμ†μ λ€μ†λ¬Έμλ¥Ό μμ •ν•μ—¬ μ΄λ”λ¦¬μ›€ μ£Όμ†μ— λ€ν•΄ μ΄μ „ λ²„μ „κ³Ό νΈν™λλ” μ²΄ν¬μ„¬μ„ μ κ³µν•λ‹¤. μ΄λ”λ¦¬μ›€ μ£Όμ†λ” λ€μ†λ¬Έμλ¥Ό κµ¬λ¶„ν•μ§€ μ•μΌλ©°, λ¨λ“  μ§€κ°‘μ€ ν•΄μ„μ μ°¨μ΄ μ—†μ΄ λ€λ¬Έμ λλ” μ†λ¬Έμλ΅ ν‘ν„λ μ΄λ”λ¦¬μ›€ μ£Όμ†λ¥Ό μμ©ν•΄μ•Ό ν•λ‹¤λ” κ²ƒμ΄λ‹¤.

μ£Όμ†μ μ•νλ²³ λ€μ†λ¬Έμλ¥Ό μμ •ν•¨μΌλ΅μ¨ μ…λ ¥μ λ¬΄κ²°μ…©μ„ λ³΄νΈν•κΈ° μ„ν•΄ μ‚¬μ©ν•  μ μλ” μ²΄ν¬μ„¬μ„ μ „λ‹¬ν•  μ μλ‹¤. EIP-55 μ²΄ν¬μ„¬μ„ μ§€μ›ν•μ§€ μ•λ” μ§€κ°‘μ€ μ£Όμ†μ— λ€λ¬Έμκ°€ νΌμ©λλ‹¤λ” μ‚¬μ‹¤μ„ λ¬΄μ‹ν•μ§€λ§, μ΄λ¥Ό μ§€μ›ν•λ” μ‚¬μ©μλ” μ£Όμ†λ¥Ό ν™•μΈν•κ³  99.986%μ μ •ν™•λ„λ΅ μ¤λ¥λ¥Ό κ°μ§€ν•  μ μλ‹¤.

νΌν•© λ€λ¬Έμ μΈμ½”λ”©μ€ λ―Έλ¬ν•κΈ° λ•λ¬Έμ— μ²μμ—λ” μΈμ‹ν•μ§€ λ»ν•  μλ„ μλ‹¤. μμ  μ£Όμ†λ” λ‹¤μκ³Ό κ°™λ‹¤.

```
0x001d3f1ef827552ae1114027bd3ecf1f086ba0f9
```

EIP-55 νΌν•© λ€λ¬Έμ μ²΄ν¬μ„¬μ„ μ‚¬μ©ν•λ©΄ λ‹¤μκ³Ό κ°™μ΄ λλ‹¤.

```
0x001d3F1ef827552Ae1114027BD3ECF1f086bA0F9
```

16μ§„μ μΈμ½”λ”© μ•νλ²³μ μΌλ¶€ μ•νλ²³(A~F) λ¬Έμλ” λ€λ¬ΈμμΈ λ°λ©΄, κ·Έ λ°–μ λ¬Έμλ” μ†λ¬Έμλ‹¤.

EIP-55λ” κµ¬ν„ν•κΈ° μ‰½λ‹¤. μ†λ¬Έμ 16μ§„μ μ£Όμ†μ Keccak-256 ν•΄μ‹λ¥Ό μ‚¬μ©ν•λ”λ°, μ΄ ν•΄μ‹λ” μ£Όμ†μ λ””μ§€ν„Έ μ§€λ¬Έ μ—­ν• μ„ ν•λ©° νΈλ¦¬ν• μ²΄ν¬μ„¬μ„ μ κ³µν•λ‹¤. μ…λ ¥(μ£Όμ†)μ΄ μ΅°κΈλ§ λ³€κ²½λλ©΄ κ²°κ³Ό ν•΄μ‹(μ²΄ν¬μ„¬)κ°€ ν¬κ² λ³€κ²½λμ–΄ μ¤λ¥λ¥Ό ν¨κ³Όμ μΌλ΅ κ°μ§€ν•  μ μλ‹¤. κ·Έλ¬λ©΄ μ£Όμ†μ ν•΄μ‹κ°€ μ£Όμ† μμ²΄μ λ€λ¬Έμλ΅ μΈμ½”λ”©λλ‹¤. λ‹¨κ³„λ³„λ΅ λ‚λ„μ–΄λ³΄μ.

1. 0x μ ‘λ‘μ–΄ μ—†μ΄ μ†λ¬Έμ μ£Όμ†λ¥Ό ν•΄μ‹ μ²λ¦¬ν•λ‹¤.

```
Keccak256("001d3f1ef827552ae1114027bd3ecf1f086ba0f9") =
23a69c1653e4ebbb619b0b2cb8a9bad49892a8b9695d9a19d8f673ca991deae1
```

2. ν•΄μ‹μ ν•΄λ‹Ή 16μ§„μκ°€ 0x8 μ΄μƒμΈ κ²½μ° κ° μ•νλ²³ λ¬Έμλ¥Ό λ€λ¬Έμλ΅ λ§λ“¤μ–΄λΌ. μ£Όμ†μ™€ ν•΄μ‹λ¥Ό μ •λ ¬ν•λ©΄ ν‘μ‹ν•κΈ°κ°€ λ” μ‰½λ‹¤.

```
Address: 001d3f1ef827552ae1114027bd3ecf1f086ba0f9
Hash   : 23a69c1653e4ebbb619b0b2cb8a9bad49892a8b9...
```

μ°λ¦¬ μ£Όμ†μ—λ” λ„¤ λ²μ§Έ μ„μΉμ— μ•νλ²³ λ¬Έμ dκ°€ λ“¤μ–΄ μλ‹¤. ν•΄μ‹μ λ„¤ λ²μ§Έ λ¬Έμλ” 6λ³΄λ‹¤ μ‘λ‹¤. λ”°λΌμ„ dλ” μ†λ¬Έμλ΅ λ‚¨κ²¨λ‘”λ‹¤. μ°λ¦¬ μ£Όμ†μ λ‹¤μ μ•νλ²³ λ¬Έμλ” μ—¬μ„― λ²μ§Έ μ„μΉμ— μλ” fμ΄λ‹¤. 16μ§„μ ν•΄μ‹μ μ—¬μ„― λ²μ§Έ λ¬Έμλ” cλ³΄λ‹¤ ν¬κ³  8μ΄λ‹¤. λ”°λΌμ„ μ£Όμ†μ—μ„ Fλ¥Ό λ€λ¬Έμλ΅ λ³€ν™ν•λ” μ‹μ΄λ‹¤. λ³΄λ‹¤μ‹ν”Ό, ν•΄μ‹μ μ²μ 20λ°”μ΄νΈ(40μμ 16μ§„μ)λ§ μ²΄ν¬μ„¬μΌλ΅ μ‚¬μ©ν•λ‹¤. μ£Όμ†μ— 20λ°”μ΄νΈ(40μμ 16μ§„μ)κ°€ μ μ ν•κ² λ€λ¬Έμλ΅ λμ–΄ μκΈ° λ•λ¬Έμ΄λ‹¤.

κ²°κ³Όλ΅ λ‚μ¨ νΌν•© λ€λ¬Έμλ¥Ό μ§μ ‘ ν™•μΈν•κ³ , λ€λ¬Έμλ΅ λ λ¬Έμμ™€ μ£Όμ† ν•΄μ‹μ— ν•΄λ‹Ήν•λ” λ¬Έμλ¥Ό μ• μ μλ”μ§€ ν™•μΈν•΄ λ³΄μ.

```
Address: 001d3F1ef827552Ae1114027BD3ECF1f086bA0F9
Hash   : 23a69c1653e4ebbb619b0b2cb8a9bad49892a8b9...
```

**EIP-55λ΅ μΈμ½”λ”©λ μ£Όμ†μ μ¤λ¥ κ°μ§€**

μ΄μ  EIP-55 μ£Όμ†κ°€ μ¤λ¥λ¥Ό μ°Ύλ” λ° μ–΄λ–»κ² λ„μ›€μ΄ λλ”μ§€ μ‚΄ν΄λ³΄μ. EIP-55λ΅ μΈμ½”λ”©λ μ΄λ”λ¦¬μ›€ μ£Όμ†λ¥Ό μΈμ‡„ν–λ‹¤κ³  κ°€μ •ν•΄ λ³΄μ.

```
0x001d3F1ef827552Ae1114027BD3ECF1f086bA0F9
```

μ΄μ  κ·Έ μ£Όμ†λ¥Ό μ½λ” λ° μμ–΄ κΈ°λ³Έμ μΈ μ‹¤μλ¥Ό ν•΄λ³΄μ. λ§μ§€λ§‰ λ¬Έμ μ΄μ „μ λ¬Έμλ” λ€λ¬Έμ Fμ΄λ‹¤. μ΄ μμ‹μ—μ„λ” κ·Έ λ¬Έμλ¥Ό λ€λ¬Έμ Eλ΅ μλ» μ½μ—λ‹¤κ³  κ°€μ •ν•κ³  λ‹¤μ (μλ»λ) μ£Όμ†λ¥Ό μ§€κ°‘μ— μ…λ ¥ν•λ‹¤.

```
0x001d3F1ef827552Ae1114027BD3ECF1f086bA0E9
```

λ‹¤ν–‰νλ„ μ§€κ°‘μ€ EIP-55λ¥Ό μ¤€μν•λ‹¤. λ€μ†λ¬Έμκ°€ νΌμ©λμμ„ ν™•μΈν•κ³  μ£Όμ†μ μ ν¨μ„±μ„ κ²€μ‚¬ν•λ‹¤. μ†λ¬Έμλ΅ λ³€ν™ν•κ³  μ²΄ν¬μ„¬ ν•΄μ‹λ¥Ό κ³„μ‚°ν•λ‹¤.

```
Keccak256("001d3f1ef827552ae1114027bd3ecf1f086ba0e9") =
5429b5d9460122fb4b11af9cb88b7bb76d8928862e0a57d46dd18dd8e08a6927
```

λ³΄λ‹¤μ‹ν”Ό, μ£Όμ†κ°€ ν• λ¬Έμμ”© λ³€κ²½λλ”λΌλ„(μ‚¬μ‹¤ eμ™€ fκ°€ 1λΉ„νΈμ”© λ–¨μ–΄μ Έ μκΈ° λ•λ¬Έμ— μ‹¤μ λ΅λ” ν• λΉ„νΈλ§ μ‚¬μ©λ¨) μ£Όμ†μ ν•΄μ‹κ°€ κΈ‰κ²©ν•κ² λ³€κ²½λμ—λ‹¤. μ΄κ²ƒμ€ μ²΄ν¬μ„¬μ— μ μ©ν•κ² μ“Έ μ μλ” ν•΄μ‹ ν•¨μμ μ†μ„±μ΄λ‹¤.

μ΄μ  λ‘ κ°€μ§€λ¥Ό μ •λ¦¬ν•κ³  λ€λ¬Έμλ¥Ό ν™•μΈν•΄ λ³΄μ.

```
001d3F1ef827552Ae1114027BD3ECF1f086bA0E9
5429b5d9460122fb4b11af9cb88b7bb76d892886...
```

λ¨λ‘ μλ»λλ‹¤. μ•νλ²³ λ¬Έμ μ¤‘ μΌλ¶€κ°€ λ€λ¬Έμλ΅ μλ» ν‘μ‹λμ—λ‹¤. λ€μ†λ¬Έμλ” 'μ¬λ°”λ¥Έ' μ²΄ν¬μ„¬μ μΈμ½”λ”©μ„μ„ κΈ°μ–µν•μ.

μ…λ ¥ν• μ£Όμ†μ λ€λ¬Έμ μ‚¬μ©μ€ κ³„μ‚°λ μ²΄ν¬μ„¬κ³Ό μΌμΉν•μ§€ μ•μΌλ―€λ΅ μ£Όμ†κ°€ λ³€κ²½λμ–΄ μ¤λ¥κ°€ λ°μƒν–λ‹¤.

## **7. κ²°λ΅ **

μ΄ μ¥μ—μ„λ” κ³µκ°ν‚¤ μ•”νΈν™”λ¥Ό κ°„λµν•κ² μ‚΄ν΄λ³΄κ³ , μ΄λ”λ¦¬μ›€μ—μ„ κ³µκ°ν‚¤ λ° κ°μΈν‚¤ μ‚¬μ©κ³Ό ν•΄μ‹ ν•¨μ κ°™μ€ μ•”νΈν™” λ„κµ¬λ¥Ό μ‚¬μ©ν•μ—¬ μ΄λ”λ¦¬μ›€ μ£Όμ†λ¥Ό λ§λ“¤κ³  κ²€μ •ν•λ” λ° μ¤‘μ μ„ λ‘μ—λ‹¤. λν• λ””μ§€ν„Έ μ„λ…κ³Ό κ°μΈν‚¤λ¥Ό κ³µκ°ν•μ§€ μ•κ³  κ°μΈν‚¤μ μ†μ κ¶μ„ μ…μ¦ν•  μ μλ” λ°©λ²•μ— λ€ν•΄μ„λ„ μ‚΄ν΄λ΄¤λ‹¤.
