# **Chapter 4. μ•”νΈν•™**
> λ³Έ κΈ€μ€ γ€Mastering Ethereumγ€μ„ μ½κ³  μ •λ¦¬ν• λ‚΄μ©μ…λ‹λ‹¤.

μ΄λ”λ¦¬μ›€μ κΈ°λ° κΈ°μ  μ¤‘ ν•λ‚λ” μ»΄ν“¨ν„° λ³΄μ•μ— κ΄‘λ²”μ„ν•κ² μ‚¬μ©λλ” μν•™μ ν• λ¶„μ•ΌμΈ `μ•”νΈν•™(cryptography)`μ΄λ‹¤. μ•”νΈν•™μ€ κ·Έλ¦¬μ¤μ–΄λ΅ `λΉ„λ°€ μ‘μ„±`μ„ μλ―Έν•μ§€λ§, μ•”νΈν•™ μ—°κµ¬λ” `μ•”νΈν™”(encryption)`λΌκ³  ν•λ” λ‹¨μν• λΉ„λ°€ μ‘μ„± μ΄μƒμ κ²ƒμ„ ν¬ν•¨ν•λ‹¤. μλ¥Ό λ“¤μ–΄ μ•”νΈν•™μ€ κ·Έ λΉ„λ°€μ„ λ°νμ§€ μ•κ³  λΉ„λ°€μ μ§€μ‹μ„ μ¦λ…ν•κ±°λ‚(μ: λ””μ§€ν„Έ μ„λ…μ„ μ‚¬μ©ν•μ—¬), λ°μ΄ν„°μ μ§„μ„μ„±μ„ μ¦λ…ν•λ” λ°(μ: ν•΄μ‹λΌκ³ λ„ μ•λ ¤μ§„ λ””μ§€ν„Έ μ§€λ¬Έμ„ ν™μ©ν•μ—¬) μ‚¬μ©ν•  μ μλ‹¤. μ΄λ° μ ν•μ μ•”νΈν™” μ¦λ…μ€ μ΄λ”λ¦¬μ›€ ν”λ«νΌ(μ‹¤μ λ΅ λ¨λ“  λΈ”λ΅μ²΄μΈ μ‹μ¤ν…)μ μ‘λ™μ„ μ„ν• μ¤‘μ”ν• μν•™ λ„κµ¬μ΄λ©°, μ΄λ”λ¦¬μ›€ μ• ν”λ¦¬μΌ€μ΄μ…μ—λ„ κ΄‘λ²”μ„ν•κ² μ‚¬μ©ν•λ‹¤.

μ¶ν μ‹μ  κΈ°μ¤€μΌλ΅ μ΄λ”λ¦¬μ›€ ν”„λ΅ν† μ½μ μ–΄λ–¤ λ¶€λ¶„λ„ μ•”νΈν™”λμ–΄ μμ§€ μ•λ‹¤. μ¦‰, μ΄λ”λ¦¬μ›€ ν”λ«νΌκ³Ό λ…Έλ“ κ°„(νΈλμ­μ… λ°μ΄ν„° ν¬ν•¨)μ λ¨λ“  ν†µμ‹ μ€ μ•”νΈν™”λμ–΄ μμ§€ μ•κ³ , (λ”°λΌμ„) λ„κµ¬λ‚ κ·Έ λ‚΄μ©μ„ μ½μ„ μ μλ‹¤. μ΄λ ‡κ² ν•΄μ„ λ¨λ“  μ‚¬λμ΄ μƒνƒ μ—…λ°μ΄νΈμ μ •ν™•μ„±μ„ ν™•μΈν•  μ μκ³ , ν•©μμ— λ„λ‹¬ν•  μ μλ‹¤. ν–¥ν›„μ—λ” μ μ§€μ‹ μ¦λ…(zero knowledge proof)κ³Ό λ™ν• μ•”νΈν™”(homomorphic encryption) κ°™μ€ κ³ κΈ‰ μ•”νΈν™” λ„κµ¬λ¥Ό μ‚¬μ©ν•μ—¬ μ—¬μ „ν ν•©μλ¥Ό κ°€λ¥ν•κ² ν•λ©΄μ„λ„ μ•”νΈν™”λ κ³„μ‚°μ„ λΈ”λ΅μ²΄μΈμ— κΈ°λ΅ν•  μ μμ„ κ²ƒμ΄λ‹¤. ν•μ§€λ§ κ³ κΈ‰ μ•”νΈν™” λ„κµ¬λ¥Ό μ κ³µν•  μ¤€λΉ„λ” λ§μ³¤μΌλ‚ μ•„μ§ λ°°ν¬λμ§€λ” μ•μ•λ‹¤.

μ΄ μ¥μ—μ„λ” μ΄λ”λ¦¬μ›€μ—μ„ μ‚¬μ©ν•λ” μ•”νΈ λ°©μ‹, μ¦‰ κ°μΈν‚¤μ™€ μ£Όμ†μ ν•νƒλ΅ μκΈμ μ†μ κ¶μ„ μ μ–΄ν•λ” λ° μ‚¬μ©λλ” κ³µκ°ν‚¤ μ•”νΈν™”(Public Key Cryptography, PKC)λ¥Ό μ†κ°ν•λ‹¤.

## **1. ν‚¤μ™€ μ£Όμ†**

μ΄λ”λ¦¬μ›€μ€ `μ™Έλ¶€ μ†μ  κ³„μ •(Externally Owned Account, EOA)`κ³Ό `μ»¨νΈλ™νΈ(contract)`λΌλ” λ‘ κ°€μ§€ μ ν•μ„ κ³„μ •μ„ κ°–κ³  μλ‹¤. λ””μ§€ν„Έ `κ°μΈν‚¤(private key)`, `μ΄λ”λ¦¬μ›€ μ£Όμ†(Ethereum address)`, `λ””μ§€ν„Έ μ„λ…(digital signature)`μ„ ν†µν•΄ μ™Έλ¶€ μ†μ  κ³„μ •μ μ΄λ” μ†μ κ¶μ„ ν™•λ¦½ν•λ‹¤. κ°μΈν‚¤λ” λ¨λ“  μ‚¬μ©μμ™€ μ΄λ”λ¦¬μ›€ κ°„ μƒνΈμ‘μ©μ ν•µμ‹¬μ΄λ‹¤. μ‚¬μ‹¤, κ³„μ • μ£Όμ†λ” κ°μΈν‚¤μ—μ„ μ§μ ‘ νμƒλκ³ , κ°μΈν‚¤λ” `κ³„μ •(account)`μ΄λΌκ³ λ„ λ¶λ¦¬λ” λ‹¨μΌ μ΄λ”λ¦¬μ›€ μ£Όμ†λ¥Ό κ³ μ ν•κ² κ²°μ •ν•λ‹¤.

μ΄λ”λ¦¬μ›€ μ‹μ¤ν…μ€ κ°μΈν‚¤λ¥Ό μ΄λ”λ¦¬μ›€μ— μ „μ†΅ν•κ±°λ‚ μ €μ¥ν•λ” λ°©μ‹μΌλ΅ μ§μ ‘ μ‚¬μ©ν•μ§€ μ•λ”λ‹¤. μ¦‰, κ°μΈν‚¤λ” λΉ„κ³µκ°λ΅ μ μ§€λμ–΄μ•Ό ν•κ³ , λ„¤νΈμ›ν¬λ΅ μ „λ‹¬λ λ©”μ‹μ§€μ— λ‚νƒ€λ‚μ§€ μ•μΌλ©°, μ²΄μΈμ— μ €μ¥λμ–΄μ„λ„ μ• λλ‹¤. κ³„μ • μ£Όμ†μ™€ λ””μ§€ν„Έ μ„λ…λ§ μ΄λ”λ¦¬μ›€ μ‹μ¤ν…μ— μ „μ†΅λκ³  μ €μ¥λλ‹¤. κ°μΈν‚¤λ” μ•μ „ν•κ³  ν™•μ‹¤ν•κ² λ³΄κ΄€ν•΄μ•Ό ν•λ‹¤.

κ°μΈν‚¤λ¥Ό μ‚¬μ©ν•μ—¬ μƒμ„±λ λ””μ§€ν„Έ μ„λ…μ„ ν†µν•΄ μκΈμ μ ‘κ·Όκ³Ό ν†µμ κ°€ μ΄λ£¨μ–΄μ§„λ‹¤. μ΄λ”λ¦¬μ›€ νΈλμ­μ…μ€ μ ν¨ν• λ””μ§€ν„Έ μ„λ…μ΄ λΈ”λ΅μ²΄μΈμ— μμ–΄μ•Ό ν•λ‹¤. κ°μΈν‚¤μ μ‚¬λ³Έμ„ κ°€μ§„ μ‚¬λμ€ λ„κµ¬λ‚ ν•΄λ‹Ή κ³„μ •κ³Ό ν•΄λ‹Ή κ³„μ •μ΄ κ°€μ§„ μ΄λ”λ¥Ό μ μ–΄ν•  μ μλ‹¤. μ‚¬μ©μκ°€ μμ‹ μ κ°μΈν‚¤λ¥Ό μ•μ „ν•κ² μ μ§€ν•λ‹¤λ©΄, μ΄λ”λ¦¬μ›€ νΈλμ­μ…μ λ””μ§€ν„Έ μ„λ…μ€ κ°μΈν‚¤μ μ†μ κ¶μ„ μ¦λ…ν•κΈ° λ•λ¬Έμ— μκΈμ μ‹¤μ  μ†μ μμ„λ„ μ¦λ…ν•λ‹¤.

μ΄λ”λ¦¬μ›€μ—μ„ μ‚¬μ©ν•λ” κ²ƒκ³Ό κ°™μ€ κ³µκ°ν‚¤ μ•”νΈν™” κΈ°λ° μ‹μ¤ν…μ—μ„ ν‚¤λ” κ°μΈ(λΉ„λ°€)ν‚¤μ™€ κ³µκ°ν‚¤λ΅ κµ¬μ„±λ μμΌλ΅ μ κ³µν•λ‹¤. κ³µκ°ν‚¤λ” μ€ν–‰ κ³„μΆ λ²νΈμ™€, κ°μΈν‚¤λ” PIN(κ°μΈ μ‹λ³„ λ²νΈ)κ³Ό μ μ‚¬ν•λ‹¤κ³  μƒκ°ν•΄ λ³΄μ. ν›„μλ” κ³„μ •μ— λ€ν• μ μ–΄κ¶μ„ μ κ³µν•κ³ , μ „μλ¥Ό κ°€μ§€κ³  κ³„μ •μ„ μ‹λ³„ν•  μ μλ‹¤. κ°μΈν‚¤ μμ²΄λ” μ΄λ”λ¦¬μ›€ μ‚¬μ©μμ—κ² λ“λ¬λ‚λ” κ²½μ°κ°€ κ±°μ μ—†λ‹¤. λ€λ¶€λ¶„ μ•”νΈν™”λ ν•νƒλ΅ νΉμ νμΌμ— μ €μ¥ν•κ³ , μ΄λ”λ¦¬μ›€ μ§€κ°‘ μ†ν”„νΈμ›¨μ–΄λ΅ κ΄€λ¦¬ν•λ‹¤.

μ΄λ”λ¦¬μ›€ νΈλμ­μ…μ μ§€κΈ‰ λ¶€λ¶„μ—μ„ μ§€μ •λ μμ‹ μλ” μ΄λ”λ¦¬μ›€ μ£Όμ†λ΅ ν‘μ‹ν•λ©°, μ΄ μ£Όμ†λ” μ€ν–‰ μ†΅κΈμ μμµμ κ³„μΆ μ„Έλ¶€ μ •λ³΄μ™€ λ™μΌν• λ°©μ‹μΌλ΅ μ‚¬μ©ν•λ‹¤. μ΄ν›„μ— μμ„Έν λ³Ό μ μλ“―μ΄ μ™Έλ¶€ μ†μ  κ³„μ •μ μ΄λ”λ¦¬μ›€ μ£Όμ†λ” κ³µκ°ν‚¤-κ°μΈν‚¤ μμ κ³µκ°ν‚¤ λ¶€λ¶„μ—μ„ μƒμ„±λλ‹¤. κ·Έλ¬λ‚ λ¨λ“  μ΄λ”λ¦¬μ›€ μ£Όμ†κ°€ κ³µκ°ν‚¤-κ°μΈν‚¤ μμ„ λ‚νƒ€λ‚΄λ” κ²ƒμ€ μ•„λ‹λ‹¤. κ°μΈν‚¤λ΅ λ’·λ°›μΉ¨λμ§€ μ•λ” μ»¨νΈλ™νΈλ¥Ό ν‘μ‹ν•  μλ„ μλ‹¤.

## **2. κ³µκ°ν‚¤ μ•”νΈν™”μ™€ μ•”νΈν™”ν**

κ³µκ°ν‚¤ μ•”νΈν™”(λΉ„λ€μΉ­ μ•”νΈν™”λΌκ³ λ„ ν•¨)λ” μ¤λλ‚  μ •λ³΄ λ³΄μ•μ ν•µμ‹¬ μ”μ†λ‹¤. 1970λ…„λ€ λ§ν‹΄ ν—¬λ¨Ό(Martin Hellman), ν«ν•„λ“ λ””ν”Ό(Whitfield Diffie), λ„ν”„ λ¨Έν΄(Ralph Merkle)μ΄ μ²μ κ³µκ°ν• μ΄ κΈ°λ²•μ€ μ•”νΈν•™ λ¶„μ•Όμ—μ„ λ€μ¤‘μ κ΄€μ‹¬μ„ λ¶λ¬μΌμΌν‚¨ κΈ°λ…λΉ„μ μΈ λνκµ¬μ€λ‹¤. 70λ…„λ€ μ΄μ „μ—, μ •λ¶€λ” κ°•λ ¥ν• μ•”νΈν•™ μ§€μ‹μ„ λΉ„λ°€λ΅ μ μ§€ν–λ‹¤.

κ³µκ°ν‚¤ μ•”νΈν™”λ” κ³ μ ν• ν‚¤λ¥Ό μ‚¬μ©ν•μ—¬ μ •λ³΄λ¥Ό λ³΄νΈν•λ‹¤. μ΄ ν‚¤λ” νΉμν• μ†μ„±(κ³„μ‚°ν•κΈ°λ” μ‰½μ§€λ§ κ·Έ μ—­(inverse)μ„ κ³„μ‚°ν•κΈ°λ” μ–΄λ µλ‹¤)μ„ κ°€μ§„ μν•™ ν•¨μλ¥Ό λ°”νƒ•μΌλ΅ ν•λ‹¤. μ΄λ° ν•¨μλ¥Ό λ°”νƒ•μΌλ΅ν• μ•”νΈν™”λ” λ””μ§€ν„Έ λΉ„λ°€κ³Ό μ„μ΅° λ¶κ°€λ¥ν• λ””μ§€ν„Έ μ„λ…μ„ λ§λ“¤ μ μμΌλ©°, μ΄κ²ƒμ€ μν•™ λ²•μΉ™μ— μν•΄ λ³΄μ¥λ°›λ”λ‹¤.

μλ¥Ό λ“¤μ–΄, 2κ°μ ν° μ†μλ¥Ό κ³±ν•λ” κ²ƒμ€ μ•„μ£Ό κ°„λ‹¨ν•λ‹¤. κ·Έλ¬λ‚ 2κ°μ ν° μ†μμ κ³±μ„ κ°μ•ν•  λ• μ†μΈμ(`μ†μΈμ λ¶„ν•΄(prime factorization)`λΌκ³  ν•λ” λ¬Έμ )λ¥Ό μ°Ύλ” λ¬Έμ λ” λ§¤μ° μ–΄λ µλ‹¤. 8,018,009λΌλ” μ«μκ°€ λ‘ μ†μμ κ²°κ³ΌλΌκ³  μ μ‹ν–μ„ λ• κ·Έ λ‘ μ†μλ¥Ό μ°Ύλ” κ²ƒμ΄ 8,018,009λ¥Ό λ§λ“¤κΈ° μ„ν•΄ κ·Έ μ†μλ¥Ό κ³±ν•λ” κ²ƒλ³΄λ‹¤ ν›¨μ”¬ λ” μ–΄λ µλ‹¤.

μ΄λ° μν•™ ν•¨μ μ¤‘ μΌλ¶€λ” λΉ„λ°€ μ •λ³΄λ¥Ό μ•κ³  μμ„ λ• μ‰½κ² κ±°κΎΈλ΅ κ³„μ‚°ν•  μ μλ‹¤. μ•μ μμ—μ„ μ†μΈμ μ¤‘ ν•λ‚κ°€ 2,003μ΄λΌκ³  ν•λ©΄, κ°„λ‹¨ν λ‚λ¨Έμ§€ μ†μΈμλ¥Ό μ‰½κ² μ°Ύμ„ μ μλ‹¤(8,018,009 Γ· 2,003 = 4,003). μ΄λ° ν•¨μλ” μ—­μ‚°ν•κΈ° μ„ν• λ‹¨μ¶•ν‚¤λ΅ μ‚¬μ©ν•  μ μλ” λΉ„λ°€ μ •λ³΄κ°€ μ—†μΌλ©΄ κ±°κΎΈλ΅ κ³„μ‚°ν•κΈ° μ–΄λ µκΈ° λ•λ¬Έμ— `νΈλ© λ„μ–΄ ν•¨μ(trapdoor function)`λΌκ³ λ„ ν•λ‹¤.

μ•”νΈν™”μ— μ μ©ν• μν•™ ν•¨μμ μΆ€ λ” λ°μ „λ λ²”μ£Όλ” νƒ€μ› κ³΅μ„ μ μ‚°μ  μ—°μ‚°μ„ λ°”νƒ•μΌλ΅ ν•λ‹¤. νƒ€μ› κ³΅μ„  μ‚°μ μ—μ„ μ†μλ΅ λ‚λ λ‚λ¨Έμ§€λ¥Ό κ³±ν•λ” κ²ƒμ€ κ°„λ‹¨ν•μ§€λ§, λ‚λ—μ…(μ—­ν•¨μ)μ€ μ‚¬μ‹¤μƒ λ¶κ°€λ¥ν•λ‹¤. μ΄κ²ƒμ„ `μ΄μ‚° λ΅κ·Έ λ¬Έμ (discrete logarithm problem)`λΌκ³  ν•λ©°, ν„μ¬λ” μ•λ ¤μ§„ νΈλ© λ„μ–΄λ” μ—†λ‹¤. `νƒ€μ› κ³΅μ„  μ•”νΈν™”(elliptic curve cyptography)`λ” μµμ‹  μ»΄ν“¨ν„° μ‹μ¤ν…μ—μ„ κ΄‘λ²”μ„ν•κ² ν™μ©λλ©°, μ΄λ”λ¦¬μ›€(λ° κΈ°νƒ€ μ•”νΈν™”ν)μ—μ„ κ°μΈν‚¤μ™€ λ””μ§€ν„Έ μ„λ…μ„ μ‚¬μ©ν•λ” κΈ°μ΄κ°€ λλ‹¤.

> β€» νλ¥΄λ§μ λ§μ§€λ§‰ μ •λ¦¬λ¥Ό μ¦λ…ν•λ” κ³Όμ •μ—μ„ μ“°μ€λ νƒ€μ›κ³΅μ„ μ΄λ΅ μ€ ν„μ¬ μ‹¤μƒν™μ—μ„ μ•”νΈμ²΄κ³„λ΅μ¨ λ§μ΄ μ“°μ΄κ³  μλ‹¤. λ§κµ­μ κµ­κ°€ μ•λ³΄κµ­ NSAλ„ νƒ€μ›κ³΅μ„ μ•”νΈ λ°©μ‹μ„ μ±„νƒν•κ³  μλ‹¤. νƒ€μ›κ³΅μ„ μ•”νΈμ λ€ν‘μ μΈ μ¥μ μ€ κ³µκ°ν‚¤ μ•”νΈλ°©μ‹μ—μ„ κ³µκ°ν‚¤ λ³΄λ‹¤ μ§§μ€ ν‚¤λ΅μ¨ λΉ„μ·ν• μμ¤€μ μ•μ „μ„±μ„ μ κ³µν•λ‹¤λ” κ²ƒμ΄λ‹¤. λ•λ¬Έμ— μ „μ†΅λ‰μ΄λΌλκ°€ κ³„μ‚°λ‰μ΄ μ ν•λ λ¬΄μ„ ν™κ²½λ“¤μ—μ„ κ·Έ μ¥μ μ΄ λ¶€κ°λλ‹¤. κµν†µμΉ΄λ“, μ‹ μ©μΉ΄λ“, μλ£λ³΄ν—μ¦ λ“±μ΄ νƒ€μ›κ³΅μ„ μ•”νΈμ²΄κ³„λ¥Ό μ΄μ©ν•κ³  μκ³ , λΉ„νΈμ½”μΈ λν• νƒ€μ›κ³΅μ„ μ•”νΈ λ°©μ‹μΌλ΅λ¶€ν„° λ§λ“¤μ–΄μ§„ μ‹μ¤ν…μ΄λ‹¤.

> * [μ•”νΈν•™ WIKI](https://en.wikipedia.org/wiki/Cryptography)
> * [νΈλ© λ„μ–΄ ν•¨μ WIKI](https://en.wikipedia.org/wiki/Trapdoor_function)
> * [μ†μΈμ λ¶„ν•΄](https://en.wikipedia.org/wiki/Integer_factorization)
> * [μ΄μ‚° λ΅κ·Έ](https://en.wikipedia.org/wiki/Discrete_logarithm)
> * [νƒ€μ› κ³΅μ„  μ•”νΈν™”](https://en.wikipedia.org/wiki/Elliptic-curve_cryptography)

μ΄λ”λ¦¬μ›€μ—μ„λ” κ³µκ°ν‚¤ μ•”νΈν™”(λΉ„λ€μΉ­ μ•”νΈν™”λΌκ³ λ„ ν•¨)λ¥Ό μ‚¬μ©ν•μ—¬ μ΄ μ¥μ—μ„ μ„¤λ…ν• κ³µκ°ν‚¤-κ°μΈν‚¤ μμ„ λ§λ“ λ‹¤. κ³µκ°ν‚¤λ” κ°μΈν‚¤μ—μ„ νμƒλλ―€λ΅ 'μ'μΌλ΅ κ°„μ£Όν•λ‹¤. κ·Έμ™€ ν•¨κ», κ·Έ μμ€ κ³µκ°μ μΌλ΅ μ ‘κ·Όν•  μ μλ” κ³„μ • ν•Έλ“¤(μ£Όμ†)κ³Ό κ³„μ •μ μ΄λ”μ— λ€ν• μ ‘κ·Ό κ¶ν•, κ·Έλ¦¬κ³  μ¤λ§νΈ μ»¨νΈλ™νΈλ¥Ό μ‚¬μ©ν•  λ• κ³„μ •μ΄ ν•„μ”λ΅ ν•λ” λ¨λ“  μΈμ¦μ— λ€ν• μ‚¬μ  μ μ–΄κ¶μ„ μ κ³µν•¨μΌλ΅μ¨ μ΄λ”λ¦¬μ›€ κ³„μ •μ„ λ‚νƒ€λ‚Έλ‹¤. κ°μΈν‚¤λ” κ³„μ •μ—μ„ μκΈμ„ μ§€μ¶ν•κΈ° μ„ν•΄ νΈλμ­μ…μ— μ„λ…ν•΄μ•Ό ν•λ” `λ””μ§€ν„Έ μ„λ…(digital signature)`μ„ λ§λ“λ” λ° ν•„μ”ν• κ³ μ ν• μ •λ³΄μ μ ‘κ·Όμ„ μ μ–΄ν•λ‹¤. λ””μ§€ν„Έ μ„λ…μ€ μ†μ μ λλ” μ»¨νΈλ™νΈ μ‚¬μ©μλ¥Ό μΈμ¦ν•λ” λ°λ„ μ‚¬μ©ν•λ‹¤.

> λ€λ¶€λ¶„μ μ§€κ°‘ κµ¬ν„μ—μ„ κ°μΈν‚¤μ™€ κ³µκ°ν‚¤λ” νΈμμƒ ν‚¤ μ(key pair)μΌλ΅ ν•¨κ» μ €μ¥ν•λ‹¤. κ·Έλ¬λ‚ κ³µκ°ν‚¤λ” κ°μΈν‚¤λ΅λ¶€ν„° κ°„λ‹¨ν κ³„μ‚°λ  μ μμΌλ―€λ΅ κ°μΈν‚¤λ§ μ €μ¥ν•λ” κ²ƒλ„ κ°€λ¥ν•λ‹¤.

λ””μ§€ν„Έ μ„λ…μ„ λ§λ“¤μ–΄ λ¨λ“  λ©”μ‹μ§€μ— μ„λ…ν•  μ μλ‹¤. μ΄λ”λ¦¬μ›€ νΈλμ­μ…μ—μ„λ” νΈλμ­μ… μμ²΄μ μ„Έλ¶€μ‚¬ν•­μ΄ λ©”μ‹μ§€λ΅ μ‚¬μ©λλ‹¤. μ•”νΈ μν•™(μ΄λ² μλ” νƒ€μ› κ³΅μ„  μ•”νΈν™”)μ€ λ©”μ‹μ§€(μ¦‰, νΈλμ­μ… μ„Έλ¶€ μ •λ³΄)λ¥Ό κ°μΈν‚¤μ™€ κ²°ν•©ν•μ—¬ κ°μΈν‚¤λ¥Ό μ•μ•„μ•Όλ§ λ§λ“¤ μ μλ” μ½”λ“ μƒμ„± λ°©λ²•μ„ μ κ³µν•λ‹¤. μ΄ μ½”λ“λ¥Ό λ””μ§€ν„Έ μ„λ…μ΄λΌκ³  ν•λ‹¤. μ΄λ”λ¦¬μ›€ νΈλμ­μ…μ€ κΈ°λ³Έμ μΌλ΅ νΉμ • μ΄λ”λ¦¬μ›€ μ£Όμ†λ΅ νΉμ • κ³„μ •μ— μ ‘κ·Όν•λ” μ”μ²­μ΄λ‹¤. μκΈμ„ μ΄λ™ν•κ±°λ‚ μ¤λ§νΈ μ»¨νΈλ™νΈμ™€ μƒνΈμ‘μ©ν•κΈ° μ„ν•΄ νΈλμ­μ…μ„ μ΄λ”λ¦¬μ›€ λ„¤νΈμ›ν¬λ΅ λ³΄λ‚΄λ©΄, λ¬Έμ μ μ΄λ”λ¦¬μ›€ μ£Όμ†μ— ν•΄λ‹Ήν•λ” κ°μΈν‚¤λ΅ μƒμ„±λ λ””μ§€ν„Έ μ„λ…λ„ ν•¨κ» λ³΄λ‚΄μ•Ό ν•λ‹¤. νƒ€μ› κ³΅μ„  μν•™μ΄λ€ λ””μ§€ν„Έ μ„λ…, νΈλμ­μ… μ„Έλ¶€ μ •λ³΄, μ ‘κ·Όν•λ ¤λ” μ΄λ”λ¦¬μ›€ μ£Όμ†κ°€ μΌμΉν•λ”μ§€ ν™•μΈν•μ—¬ 'λ„κµ¬λ‚' νΈλμ­μ…μ΄ μ ν¨ν•μ§€ ν™•μΈν•  μ μμμ„ μλ―Έν•λ‹¤. μ΄λ¬ν• ν™•μΈ κ³Όμ •μ—λ” κ°μΈν‚¤κ°€ μ „ν€ ν¬ν•¨λμ§€ μ•λ”λ‹¤. κ°μΈν‚¤λ” κ°μΈ μμ—­μ— λ‚¨μ•„ μλ‹¤. κ·Έλ¬λ‚ κ²€μ¦ ν”„λ΅μ„Έμ¤μ—μ„λ” μμ‹¬μ μ—¬μ§€ μ—†μ΄ κ·Έ νΈλμ­μ…μ΄ κ³µκ°ν‚¤μ— λ€μ‘λλ” κ°μΈν‚¤λ¥Ό κ°€μ§„ μ‚¬λμ— μν•΄ λ§λ“¤μ–΄μ΅μμ„ ν™•μ¦ν•  μ μλ‹¤. μ΄κ²ƒμ΄ κ³µκ°ν‚¤ μ•”νΈν™”μ 'λ§λ²•'μ΄λ‹¤.

> μ΄λ”λ¦¬μ›€ ν”„λ΅ν† μ½μ—λ” μ•”νΈν™”κ°€ μ—†κΈ° λ•λ¬Έμ—, μ΄λ”λ¦¬μ›€ λ„¤νΈμ›ν¬ λ™μ‘μ μΌλ¶€λ΅ λ³΄λ‚΄λ” λ¨λ“  λ©”μ‹μ§€λ” λ¨λ“  μ‚¬λμ΄ (λ¶κ°€ν”Όν•κ²) μ½μ„ μ μλ‹¤. λ”°λΌμ„ κ°μΈν‚¤λ” νΈλμ­μ… μΈμ¦μ„ μ„ν• λ””μ§€ν„Έ μ„λ…μ„ λ§λ“λ” λ°μ—λ§ μ‚¬μ©ν•λ‹¤.

## **3. κ°μΈν‚¤**

κ°μΈν‚¤λ” λ‹¨μν λ¬΄μ‘μ„λ΅ μ„ νƒν• μ«μλ‹¤. κ°μΈν‚¤μ μ†μ κ¶κ³Ό μ μ–΄λ” ν•΄λ‹Ή μ£Όμ†λ¥Ό μΉμΈν•λ” μ»¨νΈλ™νΈμ— λ€ν• μ ‘κ·ΌλΏλ§ μ•„λ‹λΌ ν•΄λ‹Ή μ΄λ”λ¦¬μ›€ μ£Όμ†μ™€ κ΄€λ ¨λ λ¨λ“  μκΈμ— λ€ν• μ‚¬μ©μ μ μ–΄μ κ·Όμ›μ΄λ‹¤. κ°μΈν‚¤λ” νΈλμ­μ…μ— μ“°μ΄λ” μκΈμ μ†μ κ¶μ„ μ¦λ…ν•¨μΌλ΅μ¨ μ΄λ”λ¥Ό μ†λΉ„ν•λ”λ° ν•„μ”ν• μ„λ…μ„ λ§λ“λ” λ° μ‚¬μ©λλ‹¤. κ°μΈν‚¤λ” ν•­μƒ λΉ„λ°€λ΅ μ μ§€ν•΄μ•Ό ν•λ‹¤. μ™λƒν•λ©΄ κ°μΈν‚¤λ¥Ό μ 3μμ—κ² κ³µκ°ν•λ” ν–‰μ„λ” κ°μΈν‚¤λ΅ ν™•λ³΄ν• μ»¨νΈλ™νΈμ™€ μ΄λ”μ— λ€ν• μ μ–΄ κ¶ν•μ„ μ 3μμ—κ² λ¶€μ—¬ν•λ” κ²ƒμ΄λ‚ λ§μ°¬κ°€μ§€μ΄κΈ° λ•λ¬Έμ΄λ‹¤. κ°μΈν‚¤λ” λ°λ“μ‹ λ°±μ—…ν•μ—¬ μ°λ°μ μΈ μ†μ‹¤λ΅λ¶€ν„° λ³΄νΈν•΄μ•Ό ν•λ‹¤. ν•λ² μƒμ–΄λ²„λ¦¬λ©΄ λμ°Ύμ„ μ μ—†μΌλ©°, ν•΄λ‹Ή ν‚¤λ΅ ν™•λ³΄ν• μκΈλ„ μμ›ν μƒμ–΄λ²„λ¦¬κ² λλ‹¤.

> μ΄λ”λ¦¬μ›€ κ°μΈν‚¤λ” μ«μλ‹¤. λΉ„κ³µκ°ν‚¤λ¥Ό λ¬΄μ‘μ„λ΅ μ„ νƒν•λ” λ°©λ²• μ¤‘ ν•λ‚λ” λ™μ „, μ—°ν•„, μΆ…μ΄λ¥Ό μ‚¬μ©ν•λ” κ²ƒμ΄λ‹¤. λ™μ „μ„ 256λ² λμ Έμ„ μ΄λ”λ¦¬μ›€ μ§€κ°‘μ—μ„ μ‚¬μ©ν•  μ μλ” 2μ§„μλ΅ λ μ„μμ κ°μΈν‚¤λ¥Ό μ–»μ„ μ μλ‹¤. κ³µκ°ν‚¤μ™€ μ£Όμ†λ” μ΄ κ°μΈν‚¤λ΅λ¶€ν„° μƒμ„±λ  μ μλ‹¤.

### **3-1. λ‚μλ΅ κ°μΈν‚¤ μƒμ„±**

ν‚¤λ¥Ό μƒμ„±ν•λ” κ°€μ¥ μ¤‘μ”ν• μ²« λ²μ§Έ λ‹¨κ³„λ” μ—”νΈλ΅ν”Ό, μ¦‰ λ¬΄μ‘μ„μ„±μ„ ν™•λ³΄ν•λ” κ²ƒμ΄λ‹¤. μ΄λ”λ¦¬μ›€ κ°μΈν‚¤λ¥Ό μƒμ„±ν•λ” κ²ƒμ€ κΈ°λ³Έμ μΌλ΅ 1μ—μ„ 2^256 μ‚¬μ΄μ μ«μλ¥Ό μ„ νƒν•λ” κ²ƒμ΄λΌκ³  λ³Ό μ μλ‹¤. ν•΄λ‹Ή λ²νΈλ¥Ό μ„ νƒν•λ” κ²ƒμ΄ μμΈ΅ κ°€λ¥ν•κ±°λ‚ κ²°μ •μ μ΄λΌλ©΄ μ΄ λ²νΈ μ„ νƒ λ°©λ²•μ€ μ¤‘μ”ν•΄μ§„λ‹¤. μ΄λ”λ¦¬μ›€ μ†ν”„νΈμ›¨μ–΄λ” κΈ°λ³Έ μ΄μμ²΄μ μ λ‚μ μƒμ„±κΈ°λ¥Ό μ‚¬μ©ν•μ—¬ 256κ°μ μ„μ λΉ„νΈλ¥Ό μƒμ„±ν•λ‹¤. μΌλ°μ μΌλ΅ OS λ‚μ μƒμ„±κΈ°λ” μ‚¬λμ΄ λ¬΄μ‘μ„μ μ†μ¤κ°€ λμ–΄ μ΄κΈ°ν™”λλ―€λ΅ λ‡ μ΄ λ™μ• λ§μ°μ¤λ¥Ό μ›€μ§μ΄κ±°λ‚ ν‚¤λ³΄λ“μ—μ„ μ„μμ ν‚¤λ¥Ό λ„λ¥΄λΌλ” μ”μ²­μ„ λ°›μ„ μ μλ‹¤. μ»΄ν“¨ν„°μ λ§μ΄ν¬λ΅ν° μ±„λ„μ—μ„ λ‚μ¤λ” μ°μ£Ό λ°©μ‚¬μ„  λ…Έμ΄μ¦κ°€ λ€μ•μ΄ λ  μ μλ‹¤.

μΆ€ λ” μ •ν™•ν λ§ν•μλ©΄, κ°μΈν‚¤λ” 2^256λ³΄λ‹¤ μ•½κ°„ μ‘μ€ 0μ΄ μ•„λ‹ λ§¤μ° ν° μ«μ(κ±°λ€ν• 78μλ¦¬ μ«μ, λ€λµ 1.158 x 10^77)κΉμ§€ κ°€λ¥ν•λ‹¤. μ •ν™•ν• μ«μλ” μ²« λ²μ§Έ 38μλ¦¬λ¥Ό 2^256μΌλ΅ κ³µμ ν•λ©°, μ΄λ”λ¦¬μ›€μ—μ„ μ‚¬μ©λ νƒ€μ› κ³΅μ„  μμ„λ΅ μ •μν•λ‹¤. λΉ„κ³µκ° ν‚¤λ¥Ό μƒμ„±ν•κΈ° μ„ν•΄ 256λΉ„νΈ μ«μλ¥Ό λ¬΄μ‘μ„λ΅ μ¶”μ¶ν•μ—¬ μ ν¨ν• λ²”μ„ λ‚΄μ— μλ”μ§€ ν™•μΈν•λ‹¤. ν”„λ΅κ·Έλλ° μΈ΅λ©΄μ—μ„ μ΄κ²ƒμ€ μΌλ°μ μΌλ΅ λ” ν° μ„μμ λΉ„νΈ λ¬Έμμ—΄(μ•”νΈν•™μ μΌλ΅ μ•μ „ν• μ„μμ„± μ†μ¤μ—μ„ μμ§‘λ¨)μ„ Keccak-256 λλ” SHA-256 κ°™μ€ 256λΉ„νΈ ν•΄μ‹ μ•κ³ λ¦¬μ¦μ— κ³µκΈ‰ν•¨μΌλ΅μ¨ μ΄λ£¨μ–΄ μ§„λ‹¤. λ‘ κ°€μ§€ μ•κ³ λ¦¬μ¦ λ¨λ‘ νΈλ¦¬ν•κ² 256λΉ„νΈ μλ¥Ό μƒμ„±ν•λ‹¤. κ²°κ³Όκ°€ μ ν¨ν• λ²”μ„ λ‚΄μ— μμΌλ©΄ μ μ ν• κ°μΈν‚¤κ°€ λλ‹¤. κ·Έλ ‡μ§€ μ•μΌλ©΄ λ‹¤λ¥Έ μ„μμ μ«μλ΅ λ‹¤μ‹ μ‹λ„ν•κΈ°λ§ ν•λ©΄ λλ‹¤.

 > 2^256(μ΄λ”λ¦¬μ›€ κ°μΈν‚¤ κ³µκ°„ ν¬κΈ°)μ€ λ€λ‹¨ν ν° μ«μλ‹¤. 10μ§„μλ΅ μ•½ 10^77, μ¦‰ 77μλ¦¬ μ«μλ‹¤. λΉ„κµλ¥Ό ν•΄λ³΄μλ©΄, μ°λ¦¬κ°€ λ³΄λ” μ°μ£Όλ” 10^80κ°μ μ›μλ¥Ό ν¬ν•¨ν•λ” κ²ƒμΌλ΅ μ¶”μ •λλ‹¤. λ”°λΌμ„ μ°μ£Όμ— μλ” λ¨λ“  μ›μμ— μ΄λ”λ¦¬μ›€ κ³„μ •μ„ μ κ³µν•κΈ°μ— μ¶©λ¶„ν•  λ§νΌμ κ°μΈν‚¤κ°€ μλ‹¤. ν•λ‚μ κ°μΈν‚¤λ¥Ό λ¬΄μ‘μ„λ΅ μ„ νƒν–μ„ λ•, λ„κµ°κ°€κ°€ κ·Έκ²ƒμ„ μ¶”μΈ΅ν•κ±°λ‚ μ¤μ¤λ΅ κ°™μ€ κ°’μ„ μ„ νƒν•  μ μλ” κ°€λ¥ν• λ°©λ²•μ€ ν„μ¬ μ—†λ‹¤.

 κ°μΈν‚¤ μƒμ„± ν”„λ΅μ„Έμ¤λ” μ¤ν”„λΌμΈ ν”„λ΅μ„Έμ¤λ‹¤. κ·Έκ²ƒμ€ μ΄λ”λ¦¬μ›€ λ„¤νΈμ›ν¬μ™€μ ν†µμ‹ μ΄λ‚ λ‹¤λ¥Έ μ‚¬λκ³Όμ ν†µμ‹ μ„ ν•„μ”λ΅ ν•μ§€ μ•λ”λ‹¤. λ”°λΌμ„ μ•„λ¬΄λ„ μ„ νƒν•  μ μ—†λ” μ«μλ¥Ό μ„ νƒν•λ ¤λ©΄ κ·Έκ²ƒμ€ μ •λ§λ΅ λ¬΄μ‘μ„μ μ΄μ–΄μ•Ό ν•λ‹¤. λ§μ•½ μ—¬λ¬λ¶„μ΄ μ§μ ‘ κ·Έ λ²νΈλ¥Ό μ„ νƒν•λ‹¤λ©΄, λ‹¤λ¥Έ μ‚¬λμ΄ κ·Έκ²ƒμ„ μ‹λ„ν•΄μ„ κ°™μ€ λ²νΈλ¥Ό μ°Ύμ„ μ μλ” ν™•λ¥ μ΄ λ„λ¬΄ λ†’λ‹¤. λ‚μ λ‚μ μƒμ„±κΈ°(λ€λ¶€λ¶„μ ν”„λ΅κ·Έλλ° μ–Έμ–΄μ— μλ” μμ‚¬ λ‚μ rand ν•¨μμ™€ κ°™μ€)λ¥Ό μ‚¬μ©ν•λ” κ²ƒμ€ λ³µμ ν•κΈ°κ°€ ν›¨μ”¬ λ” μ‰½κΈ° λ•λ¬Έμ— λ” λ‚μλ‹¤. μ¨λΌμΈ κ³„μ •μ μ•”νΈμ™€ λ§μ°¬κ°€μ§€λ΅ κ°μΈν‚¤λ„ μ¶”μΈ΅ν•  μ μ—†μ–΄μ•Ό ν•λ‹¤. λ‹¤ν–‰νλ„ κ°μΈν‚¤λ¥Ό κΈ°μ–µν•  ν•„μ”κ°€ μ—†μΌλ―€λ΅ κ°€λ¥ν• ν• μµμ„ μ μ ‘κ·Ό λ°©μ‹μ„ μ·¨ν•  μ μλ‹¤. μ¦‰, μ§„μ •ν• λ¬΄μ‘μ„μ„±μ΄λ‹¤.

 > μ„μμ μ«μλ¥Ό λ§λ“¤κ±°λ‚ ν”„λ΅κ·Έλλ° μ–Έμ–΄μ—μ„ μ κ³µν•λ” 'κ°„λ‹¨ν•' λ‚μ μƒμ„±κΈ°λ¥Ό μ‚¬μ©ν•λ” μ½”λ“λ” μ‘μ„±ν•μ§€ λ§λΌ. μ¶©λ¶„ν• μ—”νΈλ΅ν”Ό μ›μ²μ μ‹λ“(seed)μ™€ ν•¨κ» μ•”νΈλ΅ μ•μ „ν• μμ‚¬ λ‚μ μƒμ„±κΈ°(μ: CSPRNG)λ¥Ό μ‚¬μ©ν•λ” κ²ƒμ΄ μ¤‘μ”ν•λ‹¤. μ•”νΈλ΅ λ³΄νΈλμ–΄ μλ”μ§€ ν™•μΈν•κΈ° μ„ν•΄ μ‚¬μ©ν•κ³ μ ν•λ” λ‚μ μƒμ„±κΈ° λΌμ΄λΈλ¬λ¦¬μ λ¬Έμ„λ¥Ό ν•™μµν•λΌ. CSPRNG λΌμ΄λΈλ¬λ¦¬μ μ¬λ°”λ¥Έ κµ¬ν„μ€ ν‚¤ λ³΄μ•μ— μ¤‘μ”ν•λ‹¤.

 λ‹¤μμ€ μ„μλ΅ μƒμ„±ν• 16μ§„μ ν•μ‹μ κ°μΈν‚¤λ‹¤(256λΉ„νΈλ” 64λΉ„νΈ 16μ§„μλ΅ ν‘μ‹, κ° 4λΉ„νΈ).

 ```
 f8f8a2f43c8376ccb0871305060d7b27b0554d2cc72bccf41b2705608452f315
 ```

## **4. κ³µκ°ν‚¤**

μ΄λ”λ¦¬μ›€ κ³µκ°ν‚¤λ” νƒ€μ› κ³΅μ„ μ— μλ” `μ (point)`μΌλ΅ νƒ€μ› κ³΅μ„  λ°©μ •μ‹μ„ λ§μ΅±ν•λ” xμ™€ y μΆν‘μ μ§‘ν•©μ„ μλ―Έν•λ‹¤.

λ” κ°„λ‹¨ν• μ©μ–΄λ΅, μ΄λ”λ¦¬μ›€ κ³µκ°ν‚¤λ” ν•¨κ» κ²°ν•©λ 2κ°μ μ«μλ‹¤. μ΄ μ«μλ” κ°μΈν‚¤λ΅λ¶€ν„° `λ‹¨λ°©ν–¥μΌλ΅λ§` κ³„μ‚°ν•  μ μλ‹¤. μ¦‰, κ°μΈν‚¤κ°€ μλ” κ²½μ° κ³µκ°ν‚¤λ¥Ό κ³„μ‚°ν•κΈ°λ” μ‰½μ§€λ§, κ³µκ°ν‚¤μ—μ„ κ°μΈν‚¤λ¥Ό κ³„μ‚°ν•  μλ” μ—†λ‹¤.

κ³µκ°ν‚¤λ” μ‚¬μ‹¤μƒ λΉ„κ°€μ—­μ μΈ νƒ€μ› κ³΅μ„  κ³±μ…μ„ μ‚¬μ©ν•μ—¬ κ°μΈν‚¤λ΅λ¶€ν„° κ³„μ‚°λλ‹¤. `K = k * G`, μ—¬κΈ°μ„ kλ” κ°μΈν‚¤, `G`λ” `μƒμ„±μ μ (generator point)`μ΄λΌκ³  λ¶λ¦¬λ” μƒμμ , `K`λ” κ²°κ³Όλ΅ λ‚μ¤λ” κ³µκ°ν‚¤, `*`λ” νΉμ νƒ€μ› κ³΅μ„  κ³±ν•κΈ° μ—°μ‚°μλ‹¤. νƒ€μ› κ³΅μ„ μ„ μΌλ°μ μΈ κ³°μ…κ³Ό κ°™μ§€ μ•λ‹¤. μΌλ°μ μΈ κ³±μ…κ³Ό κΈ°λ¥μ  μ†μ„±μ„ κ³µμ ν•μ§€λ§ κ·Έκ²ƒλΏμ΄λ‹¤. μλ¥Ό λ“¤μ–΄, 'μ΄μ‚° λ΅κ·Έ μ°ΎκΈ°'(Kλ¥Ό μ•κ³  μλ” κ²½μ° kλ¥Ό κ³„μ‚°ν•λ‹¤)λ΅ μ•λ ¤μ§„ μ—­ μ—°μ‚°(μ •μƒ μμ— λ€ν• λ‚λ—μ…)μ€ κ°€λ¥ν• λ¨λ“  `k`κ°’μ„ μ‹λ„ν•λ” κ²ƒλ§νΌ μ–΄λ µλ‹¤(μ°μ£Όκ°€ ν—μ©ν•λ” κ²ƒλ³΄λ‹¤ λ” λ§μ€ μ‹κ°„μ΄ κ±Έλ¦¬λ” λ¬΄μ°¨λ³„ λ€μ… νƒμƒ‰).

κ°„λ‹¨ν λ§ν•λ©΄, νƒ€μ› κ³΅μ„ μ— λ€ν• μ‚°μ  μ—°μ‚°μ€ 'μ •κ·'μ •μ μ—°μ‚°κ³Ό λ‹¤λ¥΄λ‹¤. μ (G)μ— μ •μ(k)λ¥Ό κ³±ν•μ—¬ λ‹¤λ¥Έ μ (K)μ„ μƒμ„±ν•  μ μλ‹¤. κ·Έλ¬λ‚ λ‚λ—μ…(division)κ°™μ€ μ—°μ‚°μ΄ μ΅΄μ¬ν•μ§€ μ•μΌλ―€λ΅ κ³µκ°ν‚¤ Kλ¥Ό Gμ μΌλ΅ κ°„λ‹¨ν 'λ‚λ„μ–΄μ„' κ°μΈν‚¤ kλ¥Ό κ³„μ‚°ν•  μ μ—†λ‹¤. μ΄κ²ƒμ΄ λ‹¨λ°©ν–¥ μν•™ ν•¨μλ‹¤.

> νƒ€μ› κ³΅μ„  κ³±μ…μ€ μ•”νΈν•™μκ°€ 'λ‹¨λ°©ν–¥'ν•¨μλΌκ³  λ¶€λ¥΄λ” ν•¨μ μ ν•μ΄λ‹¤. ν• λ°©ν–¥(κ³±ν•κΈ°)μΌλ΅λ” μν–‰ν•κΈ° μ‰½κ³  λ°λ€ λ°©ν–¥(λ‚λ„κΈ°)μΌλ΅λ” μν–‰ν•κΈ°κ°€ μ‰½μ§€ μ•λ‹¤. κ°μΈν‚¤μ μ†μ μλ” μ•„λ¬΄λ„ ν•¨μλ¥Ό λλλ ¤μ„ κ³µκ°ν‚¤μ—μ„ κ°μΈν‚¤λ¥Ό κ³„μ‚°ν•  μ μ—†λ‹¤λ” κ²ƒμ„ μ•κ³  κ³µκ°ν‚¤λ¥Ό μ‰½κ² μƒμ„±ν•μ—¬ μ„Έμƒκ³Ό κ³µμ ν•  μ μλ‹¤. μ΄ μν•™μ  νΈλ¦­μ€ μ΄λ”λ¦¬μ›€ μκΈμ μ†μ κ¶κ³Ό κ³„μ•½ κ΄€λ¦¬λ¥Ό μ…μ¦ν•λ” μ„μ΅° λ¶κ°€λ¥ν•κ³  μ•μ „ν• λ””μ§€ν„Έ μ„λ…μ κΈ°μ΄κ°€ λλ‹¤.

### **4-1. νƒ€μ› κ³΅μ„  μ•”νΈν™” μ„¤λ…**

νƒ€μ› κ³΅μ„  μ•”νΈν™”λ” νƒ€μ› κ³΅μ„ μ μ μ— λ”ν•κΈ°μ™€ κ³±μ…μΌλ΅ ν‘ν„λλ” μ΄μ‚° λ€μ λ¬Έμ λ¥Ό λ°”νƒ•μΌλ΅ ν• λΉ„λ€μΉ­ λλ” κ³µκ°ν‚¤ μ•”νΈν™” μ ν•μ΄λ‹¤.

[κ·Έλ¦Ό 4-1]μ€ μ΄λ”λ¦¬μ›€μ—μ„ μ‚¬μ©ν•λ” κ²ƒκ³Ό λΉ„μ·ν• νƒ€μ› κ³΅μ„ μ ν• μλ‹¤.

> μ΄λ”λ¦¬μ›€μ€ λΉ„νΈμ½”μΈμ²λΌ secp256k1μ΄λΌλ” μ •ν™•ν• νƒ€μ› κ³΅μ„ μ„ μ‚¬μ©ν•λ‹¤. λ”°λΌμ„ λΉ„νΈμ½”μΈμ νƒ€μ› κ³΅μ„  λΌμ΄λΈλ¬λ¦¬ λ° λ„κµ¬λ¥Ό μ¬μ‚¬μ©ν•  μ μλ‹¤.

**[κ·Έλ¦Ό 4-1] νƒ€μ› κ³΅μ„ μ μ‹κ°ν™”**

![](https://images.velog.io/images/dogfootbirdfoot/post/1d7719df-eec7-4620-8b12-b8a8d7dcbb3f/%E1%84%80%E1%85%B3%E1%84%85%E1%85%B5%E1%86%B71.png)

μ΄λ”λ¦¬μ›€μ€ `λ―Έκµ­ ν‘μ¤€κΈ°μ μ—°κµ¬μ†(National Institute of Standards and Technology, NIST)`μ—μ„ μ μ •ν• `secp256k1`μ΄λΌλ” ν‘μ¤€μ— μ •μν• λ€λ΅ νΉμ • νƒ€μ› κ³΅μ„ κ³Ό μν•™ μƒμ μ§‘ν•©μ„ μ‚¬μ©ν•λ‹¤.

`secp256k1` κ³΅μ„ μ€ νƒ€μ› κ³΅μ„ μ„ μƒμ„±ν•λ” λ‹¤μ ν•¨μλ΅ μ •μν•λ‹¤.

`y^2 = (x^3 + 7)over(π”½ p)`

λλ”

`y^2 mod p = (x^3 + 7) mod p`

`mod p`(μ†μ pλ΅ λ‚λ λ‚λ¨Έμ§€)λ” μ΄ κ³΅μ„ μ΄ `π”½ p`λΌκ³  μ“°μΈ μ†μ μ°¨μ `p`μ μ ν•μ²΄μƒμ— μμμ„ λ‚νƒ€λ‚Έλ‹¤. μ—¬κΈ°μ„ `p = 2^256 β€“ 2^32 β€“ 2^9 β€“ 2^8 β€“ 2^7 β€“ 2^6 β€“ 2^4 β€“ 1`λ΅, λ§¤μ° ν° μ†μλ‹¤.

μ΄ κ³΅μ„ μ€ μ‹¤μ λ€μ‹ μ— μ†μ μ„μμ μ ν•μ²΄μƒμ— μ •μν–κΈ° λ•λ¬Έμ— 2μ°¨μ›μΌλ΅ ν©μ–΄μ Έ μλ” μ λ“¤μ ν¨ν„΄μ²λΌ λ³΄μΈλ‹¤. κ·Έλμ„ μ‹κ°ν™”ν•κΈ° μ–΄λ µλ‹¤. κ·Έλ¬λ‚ μν•™μ€ μ‹¤μμ— λ€ν• νƒ€μ› κ³΅μ„  μν•™κ³Ό λ™μΌν•λ‹¤. μλ¥Ό λ“¤μ–΄, [κ·Έλ¦Ό 4-2]μ—μ„ λ³΄μ—¬μ£Όλ” μΆν‘ μ„μ μ  ν¨ν„΄μ€ ν›¨μ”¬ μ‘μ€ μ ν•μ²΄μΈ μ†μ μ„μ 17μ νƒ€μ› κ³΅μ„ κ³Ό λ™μΌν•λ‹¤. `secp256k1` μ΄λ”λ¦¬μ›€ νƒ€μ› κ³΅μ„ μ€ ν—¤μ•„λ¦΄ μ μ—†μ„ λ§νΌ ν° μΆν‘μ—μ„ ν›¨μ”¬ λ” λ³µμ΅ν• μ  ν¨ν„΄μΌλ΅ μƒκ°ν•  μ μλ‹¤.

**[κ·Έλ¦Ό 4-2] νƒ€μ› κ³΅μ„  μ•”νΈν™” : p = 17μΌ λ• F(p)μ—μ„ νƒ€μ› κ³΅μ„ μ„ μ‹κ°ν™”**

![](https://images.velog.io/images/dogfootbirdfoot/post/92bfb01a-60fa-4eef-b4f9-e6d1fcc58d2b/%E1%84%80%E1%85%B3%E1%84%85%E1%85%B5%E1%86%B72.png)

μλ¥Ό λ“¤μ–΄, λ‹¤μμ€ `secp256k1` κ³΅μ„ μƒμ μ μΈ (x, y)λ¥Ό κ°–λ” μ  Qμ΄λ‹¤.

```
Q =
(49790390825249384486033144355916864607616083520101638681403973749255924539515,
59574132161899900045862086493921015780032175291755807399284007721050341297360)
```

[μμ  4-1]μ€ νμ΄μ¬μ„ μ‚¬μ©ν•μ—¬ μ§μ ‘ ν™•μΈν•λ” λ°©λ²•μ΄λ‹¤. λ³€μ xμ™€ yλ” μ•μ μμ™€ κ°™μ΄ μ  Qμ μΆν‘λ‹¤. λ³€μ pλ” νƒ€μ› κ³΅μ„ μ μ†μ(λ¨λ“  λ¨λ“λ΅ μ—°μ‚°μ— μ‚¬μ©λλ” μ†μ)λ‹¤. νμ΄μ¬μ λ§μ§€λ§‰ μ¤„μ€ νƒ€μ› κ³΅μ„  λ°©μ •μ‹μ΄λ‹¤(νμ΄μ¬μ % μ—°μ‚°μλ” λ¨λ“λ¬ μ—°μ‚°μλ‹¤). xμ™€ yκ°€ μ‹¤μ λ΅ νƒ€μ› κ³΅μ„ μƒμ ν• μ μ μΆν‘λΌλ©΄, κ·Έλ“¤μ€ λ°©μ •μ‹μ„ λ§μ΅±ν•κ³  κ²°κ³Όλ” 0μ΄λ‹¤(0Lμ€ κ°’μ΄ 0μ΄ κΈ΄ μ •μμ„). μ»¤λ§¨λ“λΌμΈμ— `python`μ„ μ…λ ¥ν•κ³  λ©λ΅μ—μ„ κ° μ¤„μ„ (>>> ν”„λ΅¬ν”„νΈ λ‹¤μμ—) λ³µμ‚¬ν•μ—¬ μ§μ ‘ ν•΄λ³΄μ.

**[μμ  4-1] νμ΄μ¬μ„ μ‚¬μ©ν•μ—¬ μ΄ μ μ΄ νƒ€μ› κ³΅μ„ μ— μμμ„ ν™•μΈν•¨**

```bash
Python 3.4.0 (default, Mar 30 2014, 19:23:13)
[GCC 4.2.1 Compatible Apple LLVM 5.1 (clang-503.0.38)] on darwin
Type "help", "copyright", "credits" or "license" for more information.
>>> p = 115792089237316195423570985008687907853269984665640564039457584007908834 \
671663
>>> x = 49790390825249384486033144355916864607616083520101638681403973749255924539515
>>> y = 59574132161899900045862086493921015780032175291755807399284007721050341297360
>>> (x ** 3 + 7 - y**2) % p
0L
```

### **4-2. νƒ€μ› κ³΅μ„  μ‚°μ  μ—°μ‚°**

λ§μ€ νƒ€μ› κ³΅μ„  μν•™μ€ μ°λ¦¬κ°€ ν•™κµμ—μ„ λ°°μ΄ μ •μ μ‚°μ κ³Ό λ§¤μ° ν΅μ‚¬ν•λ‹¤. νΉν μ°λ¦¬λ” λ”ν•κΈ° μ—°μ‚°μλ¥Ό μ •μν•  μ μλ‹¤. μ΄ μ—°μ‚°μλ” μ«μ μ„ μ„ λ”°λΌ μ ν”„ν•λ” λ€μ‹  κ³΅μ„ μ λ‹¤λ¥Έ μ μΌλ΅ μ ν”„ν•λ‹¤. μΌλ‹¨ μ°λ¦¬κ°€ λ§μ… μ—°μ‚°μλ¥Ό κ°€μ§€λ©΄, μ μ μ •μμ κ³±μ…μ„ μ •μν•  μ μλ‹¤. μ΄κ²ƒμ€ λ°λ³µλλ” λ§μ…κ³Ό κ°™λ‹¤.

νƒ€μ› κ³΅μ„ μ— λ‘ μ  P1κ³Ό P2κ°€ μ£Όμ–΄μ§€λ©΄ μ„Έ λ²μ§Έ μ  P3 = P1 + P2κ°€ νƒ€μ› κ³΅μ„  μ„μ— μλ„λ΅ κ³΅μ„  λ§μ…μ„ μ •μν•λ‹¤.

κΈ°ν•ν•™μ μΌλ΅ μ΄ μ„Έ λ²μ§Έ μ  P3μ€ P1κ³Ό P2 μ‚¬μ΄μ μ„ μ„ κ·Έλ ¤ κ³„μ‚°ν•λ‹¤. μ΄ μ„ μ€ μ •ν™•ν•κ² ν•λ‚μ μ¶”κ°€ μ¥μ†(λ†€λκ²λ„)μ—μ„ νƒ€μ› κ³΅μ„ κ³Ό κµμ°¨ν•λ‹¤. μ΄ μ μ„ P3' = (x, y)λΌκ³  λ¶€λ¥΄μ. μ΄μ–΄μ„ xμ¶•μ— λ°μ‚¬ν•μ—¬ P3 = (x, -y)λ¥Ό κµ¬ν•λ‹¤.


